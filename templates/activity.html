<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cannabis App - ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #e8f5e8 0%, #f0f8ff 100%);
            margin: 0;
            padding: 0;
            min-height: 100vh;
        }

        .container {
            max-width: 100%;
            margin: 0;
            background: white;
            border-radius: 0;
            box-shadow: none;
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            padding: 20px 30px;
            color: white;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .back-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 20px;
            cursor: pointer;
            text-decoration: none;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .back-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .header-title {
            text-align: center;
            flex: 1;
        }

        .header h1 {
            margin: 0;
            font-size: 24px;
            font-weight: 600;
        }

        .content {
            padding: 0;
        }

        .activity-section {
            margin-top: 5px;
            margin-bottom: 10px;
            background: #f8f9fa;
            border-radius: 15px;
            padding: 0;
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .add-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 28px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .add-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 152, 0, 0.3);
        }

        .view-reviews-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }

        .rating-info {
            display: flex;
            align-items: center;
        }

        .item-list {
            display: grid;
            gap: 2px;
        }

        .item-card {
            background: white;
            border-radius: 8px;
            padding: 8px;
            margin-bottom: 2px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            height: auto;
            display: flex;
            flex-direction: column;
            min-height: 280px;
        }

        .review-content {
            display: flex;
            flex-direction: column;
            gap: 6px;
            width: 100%;
        }

        .review-main-info {
            flex: 1;
            width: 100%;
        }

        .review-actions {
            display: flex;
            gap: 6px;
        }

        .reviewer-info-section .review-actions .action-btn {
            font-size: 10px;
            padding: 4px 8px;
            min-width: auto;
        }

        .item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .item-name {
            font-size: 16px;
            font-weight: 600;
            color: #333;
        }

        .item-date {
            font-size: 13px;
            color: #666;
            background: #f0f0f0;
            padding: 4px 8px;
            border-radius: 10px;
        }

        .item-details {
            font-size: 14px;
            color: #666;
            line-height: 1.6;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #666;
        }

        .empty-icon {
            font-size: 48px;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        .rating-stars {
            color: #ffd700;
            margin-top: 8px;
        }

        .strain-type {
            display: inline-block;
            background: #e8f5e9;
            color: #2e7d32;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-top: 8px;
        }

        @media (max-width: 600px) {
            body {
                padding: 0;
                margin: 0;
                width: 100vw;
                overflow-x: hidden;
            }

            .container {
                margin: 0;
                border-radius: 0;
                min-height: 100vh;
                width: 100vw;
                max-width: 100vw;
                overflow-x: hidden;
            }

            .item-list {
                display: grid !important;
                grid-template-columns: 1fr 1fr !important;
                gap: 4px !important;
                padding: 4px !important;
                width: 100% !important;
                margin: 0 !important;
                box-sizing: border-box !important;
            }

            .content {
                padding: 0;
                margin: 0;
                width: 100%;
                box-sizing: border-box;
            }

            .activity-section {
                padding: 4px;
                margin-bottom: 5px;
                border-radius: 0;
                width: 100%;
                box-sizing: border-box;
            }

            .section-header {
                flex-direction: column;
                gap: 10px;
                align-items: stretch;
                padding: 0 8px;
                margin-bottom: 15px;
            }

            .section-title {
                font-size: 18px;
                text-align: center;
            }

            .add-btn {
                align-self: center;
                padding: 8px 16px;
                font-size: 28px;
            }

            .item-card {
                padding: 6px;
                margin: 0;
                min-height: 380px;
                box-sizing: border-box;
                width: 100%;
                border-radius: 8px;
                background: white;
                border: none;
                overflow: hidden;
            }

            .bud-image-display {
                aspect-ratio: 1;
                margin-bottom: 10px;
            }

            .strain-name {
                font-size: 16px;
                line-height: 1.3;
                margin-bottom: 6px;
                font-weight: 700;
            }

            .bud-date {
                font-size: 12px;
                padding: 4px 8px;
            }

            .bud-detail {
                font-size: 14px;
                line-height: 1.4;
                margin-bottom: 4px;
            }

            .full-report-btn {
                font-size: 32px;
                padding: 12px 8px;
                margin-top: 10px;
                min-height: 45px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: 700;
            }

            .action-btn {
                font-size: 28px;
                padding: 10px 12px;
                min-height: 40px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-weight: 600;
            }

            .bud-content {
                gap: 8px;
            }

            .bud-main-content {
                gap: 8px;
            }

            .bud-actions {
                gap: 6px;
                margin-top: 10px;
            }

            .rating-stars {
                font-size: 14px;
            }

            .rating-text {
                font-size: 12px;
            }

            .bud-id {
                font-size: 12px;
                padding: 3px 8px;
            }

            .status-toggle-btn {
                font-size: 28px;
                padding: 10px 12px;
                min-height: 40px;
                font-weight: 600;
            }

            /* ‡∏õ‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏µ‡∏ß‡∏¥‡∏ß */
            .reviewer-by-text {
                font-size: 15px;
            }

            .reviewer-name-display {
                font-size: 17px;
            }

            .review-summary-text {
                font-size: 16px;
            }

            .tags-label {
                font-size: 14px;
            }

            .effect-tag, .aroma-tag {
                font-size: 13px;
                padding: 4px 10px;
            }

            .content-preview {
                font-size: 15px;
            }

            .expand-btn {
                font-size: 28px;
            }

            .video-review-btn {
                font-size: 19px;
                padding: 6px 10px;
                min-height: 24px;
                font-weight: 400;
            }
        }
        .bud-subtitle {
            color: #6c757d;
            font-size: 14px;
            margin: 5px 0;
        }

        .bud-id {
            color: #007bff;
            font-size: 18px;
            font-weight: 600;
            margin: 3px 0;
            background: #e3f2fd;
            padding: 2px 8px;
            border-radius: 12px;
            display: inline-block;
        }
        .bud-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            gap: 8px;
            margin-bottom: 8px;
        }

        .bud-title {
            flex: 1;
        }

        .strain-name {
            font-size: 16px;
            font-weight: 600;
            color: #333;
            margin-bottom: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .status-badge {
            display: inline-block;
            padding: 2px 6px;
            border-radius: 10px;
            font-size: 14px;
            font-weight: 600;
            margin-left: 5px;
        }

        .status-available {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .status-sold-out {
            background: #ffebee;
            color: #c62828;
        }

        .status-toggle-btn {
            background: #ff9800;
            color: white;
            border: none;
            padding: 4px 6px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            width: 100%;
            margin-bottom: 2px;
        }

        .status-toggle-btn:hover {
            background: #f57c00;
            transform: translateY(-1px);
        }

        .status-toggle-btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .bud-subtitle {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 4px;
        }

        .bud-date {
            font-size: 12px;
            color: #666;
            background: #f0f0f0;
            padding: 2px 5px;
            border-radius: 6px;
            display: inline-block;
            white-space: nowrap;
        }

        .full-report-btn {
            background: linear-gradient(135deg, #87CEEB, #6BB6FF);
            color: white;
            border: none;
            padding: 6px 8px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 20px;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            display: block;
            text-align: center;
            width: calc(100% - 4px);
            margin: 8px 2px 5px 2px;
            box-sizing: border-box;
        }

        .full-report-btn:hover {
            background: linear-gradient(135deg, #6BB6FF, #4682B4);
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(135, 206, 235, 0.3);
        }

        .item-list {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 2px;
        }

        .item-list.reviews-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            width: 100%;
        }

        .item-list.reviews-list .item-card {
            width: 100%;
            max-width: none;
        }

        @media (max-width: 1200px) {
            .item-list {
                grid-template-columns: repeat(3, 1fr);
            }

            .item-list.reviews-list {
                display: flex;
                flex-direction: column;
                gap: 12px;
            }
        }

        @media (max-width: 900px) {
            .item-list {
                grid-template-columns: repeat(2, 1fr);
            }

            .item-list.reviews-list {
                display: flex;
                flex-direction: column;
                gap: 10px;
            }
        }

        .bud-content {
            display: flex;
            flex-direction: column;
            gap: 6px;
            flex: 1;
        }

        .bud-main-content {
            display: flex;
            flex-direction: column;
            gap: 6px;
            flex: 1;
        }

        .bud-image-display {
            width: 100%;
            aspect-ratio: 1;
            border: 2px solid #ffd700;
            border-radius: 8px;
            overflow: hidden;
            background: #f8f9fa;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 5px;
            position: relative;
        }

        .bud-display-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            position: absolute;
            top: 0;
            left: 0;
        }

        .bud-image-placeholder {
            font-size: 24px;
            color: #4CAF50;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
        }

        .bud-info {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 2px;
        }

        .bud-detail {
            font-size: 14px;
            color: #333;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .rating-section {
            margin-top: 3px;
            display: flex;
            align-items: center;
            gap: 3px;
        }

        .rating-stars {
            color: #ffd700;
            font-size: 15px;
        }

        .rating-text {
            color: #666;
            font-size: 12px;
        }

        .bud-actions {
            display: flex;
            flex-direction: column;
            gap: 3px;
            width: 100%;
            margin-top: 5px;
        }

        .action-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-size: 28px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            text-align: center;
            display: inline-block;
            box-sizing: border-box;
            min-width: 80px;
        }

        .bud-actions .action-btn {
            width: 100%;
            font-size: 16px;
            padding: 4px 6px;
        }

        .action-btn.primary {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
        }

        .action-btn.primary:hover {
            background: linear-gradient(135deg, #45a049, #3d8b40);
            transform: translateY(-1px);
        }

        .action-btn.secondary {
            background: #6c757d;
            color: white;
        }

        .action-btn.secondary:hover {
            background: #5a6268;
            transform: translateY(-1px);
        }

        .action-btn.danger {
            background: #dc3545;
            color: white;
        }

        .action-btn.danger:hover {
            background: #c82333;
            transform: translateY(-1px);
        }

        .review-ratings {
            margin-bottom: 8px;
        }

        .overall-rating, .aroma-rating {
            font-size: 12px;
            margin-bottom: 4px;
        }

        .review-summary {
            font-size: 12px;
            margin-bottom: 6px;
            color: #333;
        }

        .review-full-content {
            font-size: 11px;
            margin-bottom: 6px;
        }

        .content-preview {
            color: #555;
            font-style: italic;
            line-height: 1.3;
        }

        .review-details {
            font-size: 11px;
            margin-bottom: 8px;
        }

        .review-effects, .review-aromas, .review-breeder {
            margin-bottom: 3px;
            color: #444;
        }

        .review-images-info {
            font-size: 10px;
            color: #007bff;
            margin-bottom: 6px;
        }

        .review-updated {
            margin-top: 6px;
            font-size: 10px;
        }

        .reviewer-info-section {
            margin-bottom: 4px;
            padding: 4px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 3px solid #4CAF50;
        }

        .reviewer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .reviewer-by-text {
            font-size: 12px;
            color: #666;
            font-weight: 600;
        }

        .aroma-rating-text {
            font-size: 12px;
            color: #7b1fa2;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .reviewer-display {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .reviewer-avatar-small {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: linear-gradient(135deg, #a78bfa, #60a5fa);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            color: white;
            font-weight: 600;
            overflow: hidden;
            flex-shrink: 0;
        }

        .reviewer-avatar-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .reviewer-name-display {
            font-size: 14px;
            font-weight: 600;
            color: #333;
        }

        .review-ratings-section {
            margin: 6px 0;
            padding: 6px;
            background: #f8f9fa;
            border-radius: 6px;
        }

        .rating-row {
            display: flex;
            align-items: center;
            gap: 6px;
            margin-bottom: 3px;
        }

        .rating-label {
            font-size: 12px;
            font-weight: 600;
            color: #666;
        }

        .rating-stars {
            font-size: 12px;
            color: #ff9800;
        }

        .aroma-rating {
            font-size: 11px;
            color: #9c27b0;
            margin-left: 8px;
        }

        .review-summary-text {
            font-size: 13px;
            color: #333;
            font-style: italic;
            margin-top: 5px;
        }

        .tags-section {
            margin: 4px 0;
        }

        .tags-row {
            display: flex;
            align-items: flex-start;
            gap: 4px;
            margin-bottom: 3px;
        }

        .tags-label {
            font-size: 13px;
            font-weight: 600;
            color: #666;
            min-width: 70px;
        }

        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }

        .effect-tag {
            background: #e3f2fd;
            color: #1976d2;
            padding: 2px 6px;
            border-radius: 12px;
            font-size: 13px;
            font-weight: 500;
        }

        .aroma-tag {
            background: #f3e5f5;
            color: #7b1fa2;
            padding: 2px 6px;
            border-radius: 12px;
            font-size: 13px;
            font-weight: 500;
        }

        .more-tag {
            background: #e0e0e0;
            color: #666;
            padding: 2px 6px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: 500;
        }

        .review-full-content {
            margin: 4px 0;
            padding: 6px;
            background: #ffffff;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
        }

        .content-preview {
            font-size: 13px;
            line-height: 1.4;
            color: #333;
        }

        .expand-btn {
            background: none;
            border: none;
            color: #1976d2;
            font-size: 22px;
            cursor: pointer;
            text-decoration: underline;
            margin-top: 5px;
        }

        .review-images-section {
            margin: 4px 0;
        }

        .review-images-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 3px;
            max-width: 120px;
        }

        .review-image-thumb {
            width: 100%;
            height: 25px;
            object-fit: cover;
            border-radius: 3px;
            border: 1px solid #ddd;
            cursor: pointer;
            transition: transform 0.2s ease;
        }

        .review-image-thumb:hover {
            transform: scale(1.05);
            border-color: #FF9800;
        }

        .more-images {
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f0f0f0;
            border: 1px solid #ddd;
            border-radius: 3px;
            font-size: 8px;
            color: #666;
            height: 25px;
        }

        /* Image Modal Styles */
        .image-modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.9);
            padding-top: 50px;
        }

        .modal-content {
            margin: auto;
            display: block;
            max-width: 90%;
            max-height: 80%;
            border-radius: 10px;
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            transition: 0.3s;
            cursor: pointer;
        }

        .modal-close:hover,
        .modal-close:focus {
            color: #bbb;
            text-decoration: none;
        }

        /* Video Modal Styles */
        .video-modal {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: rgba(0,0,0,0.9);
            padding-top: 50px;
            -webkit-overflow-scrolling: touch;
        }

        .video-container {
            margin: auto;
            display: block;
            max-width: 90%;
            max-height: 80%;
            text-align: center;
            position: relative;
        }

        .video-container iframe {
            max-width: 100%;
            max-height: 80vh;
            border: none;
            border-radius: 8px;
        }

        /* CSS ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£ scroll ‡πÄ‡∏°‡∏∑‡πà‡∏≠ modal ‡πÄ‡∏õ‡∏¥‡∏î */
        body.modal-open {
            overflow: hidden;
            position: fixed;
            width: 100%;
            height: 100%;
        }

        @media (max-width: 768px) {
            .video-modal {
                padding-top: 20px;
            }

            .video-container {
                max-width: 95%;
                max-height: 85%;
                margin-top: 10vh;
            }

            .video-container iframe {
                width: 90vw;
                height: 50.6vw; /* 16:9 aspect ratio */
                min-height: 200px;
                max-height: 70vh;
            }

            .modal-close {
                top: 10px;
                right: 20px;
                font-size: 35px;
                z-index: 10000;
            }
        }

        .video-section {
            margin: 8px 0;
        }

        .video-link {
            display: inline-block;
            padding: 4px 8px;
            background: #ff1744;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 11px;
            font-weight: 500;
        }

        .video-link:hover {
            background: #d50000;
        }

        .review-media-section {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 15px;
            margin-top: 15px;
        }

        .video-review-btn {
            padding: 2px 5px;
            background: #ff1744;
            color: white;
            text-decoration: none;
            border-radius: 4px;
            font-size: 13px;
            font-weight: 400;
            border: none;
            cursor: pointer;
        }

        .video-review-btn:hover {
            background: #d50000;
        }

        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #4CAF50;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-message {
            text-align: center;
            color: #dc3545;
            background: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }```text
        ```text
        .success-message {
            text-align: center;
            color: #155724;
            background: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }

        .retry-btn {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 10px;
        }

        .retry-btn:hover {
            background: #45a049;
        }

        /* Bottom Navigation Styles */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-top: 2px solid #e0e0e0;
            display: flex;
            justify-content: space-around;
            padding: 8px 0;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            z-index: 1000;
        }

        .nav-tab {
            background: none;
            border: none;
            padding: 8px 12px;
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            transition: all 0.3s ease;
            border-radius: 8px;
            flex: 1;
            max-width: 120px;
        }

        .nav-tab:hover {
            background: #f0f0f0;
        }

        .nav-tab.active {
            background: #e8f5e9;
            color: #4CAF50;
        }

        .nav-tab.active .nav-icon {
            transform: scale(1.1);
        }

        .nav-icon {
            font-size: 24px;
            transition: transform 0.3s ease;
        }

        .nav-label {
            font-size: 12px;
            font-weight: 600;
            text-align: center;
            line-height: 1.2;
        }

        /* Add bottom padding to content to avoid overlap with bottom nav */
        .content {
            padding-bottom: 80px;
        }

        @media (max-width: 600px) {
            .bottom-nav {
                padding: 6px 0;
            }

            .nav-tab {
                padding: 6px 8px;
                gap: 2px;
            }

            .nav-icon {
                font-size: 20px;
            }

            .nav-label {
                font-size: 10px;
            }

            .content {
                padding-bottom: 70px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="/profile" class="back-btn">‚Üê ‡∏Å‡∏•‡∏±‡∏ö</a>
            <div class="header-title">
                <h1>üåø ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</h1>
            </div>
            <div style="width: 60px;"></div>
        </div>

        <div class="content">
            <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏î‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏°‡∏µ -->
            <div class="activity-section" id="myBudsSection">
                <div class="section-header">
                    <div class="section-title">
                        üå∏ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏î‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ
                    </div>
                    <a href="/add-buds" class="add-btn">
                        ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏î‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ
                    </a>
                </div>

                <div class="item-list" id="budsList">
                    <div class="empty-state">
                        <div class="loading-spinner"></div>
                        <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏≠‡∏Å...</p>
                    </div>
                </div>
            </div>

            <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì -->
            <div class="activity-section" id="myReviewsSection" style="display: none;">
                <div class="section-header">
                    <div class="section-title">
                        ‚≠ê ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì
                    </div>
                    <a href="/add-review" class="add-btn">
                        ‚ûï ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏µ‡∏ß‡∏¥‡∏ß
                    </a>
                </div>

                <div class="item-list reviews-list" id="reviewsList">
                    <div class="empty-state">
                        <div class="loading-spinner"></div>
                        <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏µ‡∏ß‡∏¥‡∏ß...</p>
                    </div>
                </div>
            </div>

            <!-- ‡∏™‡πà‡∏ß‡∏ô‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏à‡∏≤‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÜ -->
            <div class="activity-section" id="friendsReviewsSection" style="display: none;">
                <div class="section-header">
                    <div class="section-title">
                        üë• ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏à‡∏≤‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÜ
                    </div>
                </div>

                <div class="item-list reviews-list" id="friendsReviewsList">
                    <div class="empty-state">
                        <div class="loading-spinner"></div>
                        <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏à‡∏≤‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation Bar -->
        <div class="bottom-nav">
            <button class="nav-tab active" onclick="switchTab('myBuds')">
                <div class="nav-icon">üåø</div>
                <div class="nav-label">‡∏î‡∏≠‡∏Å‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>
            </button>
            <a href="/my-reviews" class="nav-tab" style="text-decoration: none; color: inherit;">
                <div class="nav-icon">‚≠ê</div>
                <div class="nav-label">‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡πÇ‡∏î‡∏¢‡∏Ñ‡∏∏‡∏ì</div>
            </a>
            <a href="/friends-reviews" class="nav-tab" style="text-decoration: none; color: inherit;">
                <div class="nav-icon">üë•</div>
                <div class="nav-label">‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏à‡∏≤‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÜ</div>
            </a>
            <a href="/profile" class="nav-tab" style="text-decoration: none; color: inherit;">
                <div class="nav-icon">üë§</div>
                <div class="nav-label">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</div>
            </a>
        </div>
    </div>

    <!-- Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏π‡∏£‡∏π‡∏õ‡∏Ç‡∏¢‡∏≤‡∏¢ -->
    <div id="imageModal" class="image-modal">
        <span class="modal-close" onclick="closeImageModal()">&times;</span>
        <img id="modalImage" class="modal-content">
    </div>

    <!-- Modal ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏π‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ YouTube -->
    <div id="videoModal" class="video-modal">
        <span class="modal-close" onclick="closeVideoModal()">&times;</span>
        <div class="video-container">
            <iframe id="youtubePlayer" width="800" height="450" frameborder="0" allowfullscreen></iframe>
        </div>
    </div>

    <script>
        // Global variables
        let reviewsData = [];
        let budsData = [];
        let friendsReviewsData = [];
        let isLoadingBuds = false;
        let isLoadingReviews = false;
        let isLoadingFriendsReviews = false;
        let currentTab = 'myBuds';

        // Load user's buds data with improved performance
        async function loadBuds() {
            if (isLoadingBuds) return;

            isLoadingBuds = true;
            const budsList = document.getElementById('budsList');

            try {
                budsList.innerHTML = `
                    <div class="empty-state">
                        <div class="loading-spinner"></div>
                        <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏≠‡∏Å...</p>
                    </div>
                `;

                // Use AbortController for better request management
                const controller = new AbortController();
                const timeoutId = setTimeout(() => controller.abort(), 10000); // 10 second timeout

                const response = await fetch('/api/user_buds', {
                    signal: controller.signal,
                    headers: {
                        'Cache-Control': 'max-age=300' // 5 minute cache
                    }
                });

                clearTimeout(timeoutId);

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();

                if (data.error) {
                    throw new Error(data.error);
                }

                budsData = data.buds || [];
                displayBuds(budsData);

            } catch (error) {
                console.error('Error loading buds:', error);
                showBudsError(error.message || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏≠‡∏Å‡πÑ‡∏î‡πâ');
            } finally {
                isLoadingBuds = false;
            }
        }

        // Load user's reviews data
        async function loadReviews() {
            if (isLoadingReviews) return;

            isLoadingReviews = true;
            const reviewsList = document.getElementById('reviewsList');

            try {
                reviewsList.innerHTML = `
                    <div class="empty-state">
                        <div class="loading-spinner"></div>
                        <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏µ‡∏ß‡∏¥‡∏ß...</p>
                    </div>
                `;

                const response = await fetch('/api/user_reviews');

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();

                if (data.error) {
                    throw new Error(data.error);
                }

                reviewsData = data.reviews || [];
                displayReviews(reviewsData);

            } catch (error) {
                console.error('Error loading reviews:', error);
                showReviewsError(error.message || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡πÑ‡∏î‡πâ');
            } finally {
                isLoadingReviews = false;
            }
        }

        function showBudsError(message) {
            const budsList = document.getElementById('budsList');
            if (budsList) {
                budsList.innerHTML = `
                    <div class="error-message">
                        <div style="font-size: 48px; margin-bottom: 15px;">‚ùå</div>
                        <p>${message}</p>
                        <button class="retry-btn" onclick="loadBuds()">üîÑ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</button>
                    </div>
                `;
            }
        }

        function showReviewsError(message) {
            const reviewsList = document.getElementById('reviewsList');
            if (reviewsList) {
                reviewsList.innerHTML = `
                    <div class="error-message">
                        <div style="font-size: 48px; margin-bottom: 15px;">‚ùå</div>
                        <p>${message}</p>
                        <button class="retry-btn" onclick="loadReviews()">üîÑ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</button>
                    </div>
                `;
            }
        }

        function displayBuds(buds) {
            const budsList = document.getElementById('budsList');

            if (buds.length === 0) {
                budsList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üåø</div>
                        <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏î‡∏≠‡∏Å‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p>
                        <p style="font-size: 14px; color: #999;">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏î‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏Ñ‡∏∏‡∏ì‡∏°‡∏µ" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô</p>
                    </div>
                `;
                return;
            }

            budsList.innerHTML = buds.map(bud => {
                const statusText = bud.status === 'available' ? '‡∏¢‡∏±‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠' : '‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß';
                const statusClass = bud.status === 'available' ? 'status-available' : 'status-sold-out';
                const toggleText = bud.status === 'available' ? '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô ‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß' : '‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô ‡∏¢‡∏±‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠';
                const newStatus = bud.status === 'available' ? 'sold_out' : 'available';

                return `
                <div class="item-card">
                    <div class="bud-header">
                        <div class="bud-title">
                            <div class="strain-name">
                                ${bud.strain_name_en || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠'} ${bud.strain_name_th ? `(${bud.strain_name_th})` : ''}
                            </div>
                            <div class="bud-subtitle">
                                <span class="bud-date">${formatDate(bud.created_at)}</span>
                                <span class="status-badge ${statusClass}">${statusText}</span>
                            </div>
                        </div>
                    </div>

                    <div class="bud-content">
                        <div class="bud-main-content">
                            <div class="bud-image-display">
                                ${bud.image_1_url ? 
                                    `<img src="${bud.image_1_url}" alt="‡∏£‡∏π‡∏õ‡∏î‡∏≠‡∏Å ${bud.strain_name_en}" class="bud-display-image" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                     <div class="bud-image-placeholder" style="display: none;">üåø</div>` :
                                    `<div class="bud-image-placeholder">üåø</div>`
                                }
                            </div>

                            <div class="bud-info">
                                <div class="bud-detail"><strong>Bud ID:</strong> ${bud.id}</div>
                                <div class="bud-detail"><strong>‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤:</strong> ${bud.breeder || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}</div>
                                <div class="bud-detail"><strong>‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó:</strong> ${bud.strain_type || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}</div>
                                <div class="bud-detail"><strong>THC:</strong> ${bud.thc_percentage || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}% | <strong>CBD:</strong> ${bud.cbd_percentage || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏'}%</div>
                                <div class="rating-section">
                                    <span class="rating-stars">${'‚≠ê'.repeat(Math.round(bud.avg_rating))}</span>
                                    <span class="rating-text">
                                        ${bud.avg_rating > 0 ? `${bud.avg_rating.toFixed(1)} (${bud.review_count} ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß)` : '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß'}
                                    </span>
                                </div>
                            </div>
                        </div>

                        <div class="bud-actions">
                            <button class="status-toggle-btn" onclick="toggleBudStatus(${bud.id}, '${newStatus}', this)">
                                üîÑ ${toggleText}
                            </button>

                            <a href="/bud-report?id=${bud.id}" class="action-btn primary">
                                üìä Full Report & all Review
                            </a>

                            <button class="action-btn secondary" onclick="editBud(${bud.id})">‚úèÔ∏è ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç</button>
                            <button class="action-btn danger" onclick="deleteBud(${bud.id})">üóëÔ∏è ‡∏•‡∏ö</button>
                        </div>
                    </div>
                </div>
                `;
            }).join('');
        }

        function displayReviews(reviews) {
            const reviewsList = document.getElementById('reviewsList');

            if (reviews.length === 0) {
                reviewsList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">‚≠ê</div>
                        <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p>
                        <p style="font-size: 14px; color: #999;">‡∏Ñ‡∏•‡∏¥‡∏Å‡∏õ‡∏∏‡πà‡∏° "‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏µ‡∏ß‡∏¥‡∏ß" ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÅ‡∏ä‡∏£‡πå‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
                    </div>
                `;
                return;
            }

            const reviewsHtml = reviews.map(review => {
                const createdDate = formatDate(review.created_at);
                const updatedDate = review.updated_at && review.updated_at !== review.created_at ? 
                    ` (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${formatDate(review.updated_at)})` : '';

                // ‡∏™‡∏£‡πâ‡∏≤‡∏á avatar ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡∏£‡∏µ‡∏ß‡∏¥‡∏ß
                const reviewerAvatar = review.reviewer_profile_image ? 
                    `<img src="${review.reviewer_profile_image}" alt="Profile" class="reviewer-avatar-img">` :
                    (review.reviewer_name ? review.reviewer_name.charAt(0).toUpperCase() : 'üë§');

                // ‡∏™‡∏£‡πâ‡∏≤‡∏á effects tags
                const effectsTags = review.selected_effects && review.selected_effects.length > 0 ? 
                    review.selected_effects.slice(0, 4).map(effect => 
                        `<span class="effect-tag">${effect}</span>`
                    ).join('') + (review.selected_effects.length > 4 ? `<span class="more-tag">+${review.selected_effects.length - 4}</span>` : '') : '';

                // ‡∏™‡∏£‡πâ‡∏≤‡∏á aroma tags
                const aromaTags = review.aroma_flavors && review.aroma_flavors.length > 0 ? 
                    review.aroma_flavors.slice(0, 3).map(aroma => 
                        `<span class="aroma-tag">${aroma}</span>`
                    ).join('') + (review.aroma_flavors.length > 3 ? `<span class="more-tag">+${review.aroma_flavors.length - 3}</span>` : '') : '';

                // ‡∏™‡∏£‡πâ‡∏≤‡∏á review images
                const reviewImages = review.review_images && review.review_images.length > 0 ? 
                    `<div class="review-images-section">
                        <div class="review-images-grid">
                            ${review.review_images.slice(0, 4).map((img, index) => 
                                `<img src="${img}" alt="Review image ${index + 1}" class="review-image-thumb" onclick="viewImage('${img}')">`
                            ).join('')}
                            ${review.review_images.length > 4 ? `<div class="more-images">+${review.review_images.length - 4}</div>` : ''}
                        </div>
                    </div>` : '';

                return `
                    <div class="item-card" data-review-id="${review.id}">
                        <div class="review-content">
                            <div class="review-main-info">
                                <div class="item-header">
                                    <div class="item-name">
                                        ${review.strain_name_th || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ó‡∏¢'} (${review.strain_name_en || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©'}) - Bud ID: ${review.bud_reference_id}
                                    </div>
                                    <div class="item-date">${createdDate}${updatedDate}</div>
                                </div>

                                <div class="reviewer-info-section">
                                    <div class="reviewer-header">
                                        <div style="display: flex; align-items: center; gap: 8px; flex: 1;">
                                            <div class="reviewer-by-text">Review by :</div>
                                            <div class="reviewer-avatar-small">
                                                ${reviewerAvatar}
                                            </div>
                                            <div class="reviewer-name-display">${review.reviewer_name || '‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠'}</div>
                                        </div>
                                        <div style="margin-top: 4px; font-size: 12px; color: #FF9800; font-weight: 600;">
                                            <div>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°: ${'‚≠ê'.repeat(review.overall_rating)} (${review.overall_rating}/5)</div>
                                            ${review.aroma_rating ? `<div>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Å‡∏•‡∏¥‡πà‡∏ô: ${'‚≠ê'.repeat(review.aroma_rating)} (${review.aroma_rating}/5)</div>` : ''}
                                        </div>
                                    </div>
                                </div>

                                <!-- ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß -->
                                <div class="review-ratings-section">
                                    <div class="review-summary-text">${review.short_summary || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏£‡∏∏‡∏õ'}</div>
                                </div>

                                <!-- Effects ‡πÅ‡∏•‡∏∞ Aromas -->
                                ${effectsTags ? `<div class="tags-section">
                                    <div class="tags-row">
                                        <span class="tags-label">üß† ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:</span>
                                        <div class="tags-container">${effectsTags}</div>
                                    </div>
                                </div>` : ''}

                                ${aromaTags ? `<div class="tags-section">
                                    <div class="tags-row">
                                        <span class="tags-label">üëÉ ‡∏Å‡∏•‡∏¥‡πà‡∏ô/‡∏£‡∏™:</span>
                                        <div class="tags-container">${aromaTags}</div>
                                    </div>
                                </div>` : ''}

                                <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡πÄ‡∏ï‡πá‡∏° (‡∏¢‡πà‡∏≠) -->
                                ${review.full_review_content ? `<div class="review-full-content">
                                    <div class="content-preview">${review.full_review_content.length > 100 ? 
                                        review.full_review_content.substring(0, 100) + '...' : 
                                        review.full_review_content}</div>
                                    ${review.full_review_content.length > 100 ? 
                                        `<button class="expand-btn" onclick="expandContent(${review.id})">‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</button>` : ''}
                                </div>` : ''}

                                <!-- ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡∏ß‡∏¥‡∏ß ‡πÅ‡∏•‡∏∞‡∏õ‡∏∏‡πà‡∏°‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏£‡∏µ‡∏ß‡∏¥‡∏ß -->
                                <div class="review-media-section">
                                    ${reviewImages}
                                    ${review.video_review_url ? `
                                        <button class="video-review-btn" onclick="playVideoReview('${review.video_review_url}'); return false;" type="button">
                                            üé• ‡∏î‡∏π‡∏£‡∏µ‡∏ß‡∏¥‡∏ß
                                        </button>
                                    ` : ''}
                                </div>

                                <!-- ‡∏õ‡∏∏‡πà‡∏° Full Report -->
                                <div style="margin-top: 10px; text-align: left;">
                                    <a href="/bud-report?id=${review.bud_reference_id}" class="full-report-btn">
                                        üìä Full Report
                                    </a>
                                </div>

                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            reviewsList.innerHTML = reviewsHtml;
        }

        // Utility functions
        function formatDate(dateString) {
            if (!dateString) return '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
            try {
                const date = new Date(dateString);
                return date.toLocaleDateString('th-TH', {
                    day: 'numeric',
                    month: 'short',
                    year: 'numeric'
                });
            } catch (error) {
                return '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏';
            }
        }

        // Action functions
        function editBud(budId) {
            if (budId) {
                window.location.href = `/edit-bud?id=${budId}`;
            }
        }

        function editReview(reviewId) {
            if (reviewId) {
                window.location.href = `/edit-review?id=${reviewId}`;
            }
        }

        function toggleBudStatus(budId, newStatus, buttonElement) {
            if (!budId || !newStatus) return;

            const statusText = newStatus === 'available' ? '‡∏¢‡∏±‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠' : '‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß';

            if (confirm(`‡∏Ñ‡∏∏‡∏ì‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÄ‡∏õ‡πá‡∏ô "${statusText}" ‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà?`)) {
                // Disable button during request
                const originalText = buttonElement.textContent;
                buttonElement.disabled = true;
                buttonElement.textContent = '‚è≥ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô...';

                fetch(`/api/buds/${budId}/status`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ status: newStatus })
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert(data.message);
                        loadBuds(); // Reload the list to reflect changes
                    } else {
                        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + (data.error || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡πÑ‡∏î‡πâ'));
                        buttonElement.disabled = false;
                        buttonElement.textContent = originalText;
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞');
                    buttonElement.disabled = false;
                    buttonElement.textContent = originalText;
                });
            }
        }

        function deleteBud(budId) {
            if (!budId) return;

            if (confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏î‡∏≠‡∏Å‡∏ô‡∏µ‡πâ? ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ')) {
                fetch(`/api/buds/${budId}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('‡∏•‡∏ö‡∏î‡∏≠‡∏Å‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                        loadBuds(); // Reload the list
                    } else {
                        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + (data.error || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡πÑ‡∏î‡πâ'));
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö');
                });
            }
        }

        function deleteReview(reviewId) {
            if (!reviewId) return;

            if (confirm('‡∏Ñ‡∏∏‡∏ì‡πÅ‡∏ô‡πà‡πÉ‡∏à‡∏´‡∏£‡∏∑‡∏≠‡πÑ‡∏°‡πà‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏ô‡∏µ‡πâ? ‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏≥‡∏ô‡∏µ‡πâ‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏¢‡πâ‡∏≠‡∏ô‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏î‡πâ')) {
                fetch(`/api/reviews/${reviewId}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                })
                .then(response => response.json())
                .then(data => {
                    if (data.success) {
                        alert('‡∏•‡∏ö‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
                        loadReviews(); // Reload the list
                    } else {
                        alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + (data.error || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏•‡∏ö‡πÑ‡∏î‡πâ'));
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏•‡∏ö');
                });
            }
        }

        // Modal functions
        function viewImage(imageUrl) {
            if (!imageUrl) return;

            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');

            if (modal && modalImg) {
                modal.style.display = 'block';
                modalImg.src = imageUrl;
            }
        }

        function closeImageModal() {
            const modal = document.getElementById('imageModal');
            if (modal) {
                modal.style.display = 'none';
            }
        }

        function openVideoModal(videoUrl) {
            if (!videoUrl) return;

            // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£ reload ‡∏´‡∏ô‡πâ‡∏≤‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠
            event.preventDefault();
            event.stopPropagation();

            const modal = document.getElementById('videoModal');
            const player = document.getElementById('youtubePlayer');

            if (!modal || !player) return;

            // ‡πÅ‡∏õ‡∏•‡∏á YouTube URL ‡πÄ‡∏õ‡πá‡∏ô embed URL
            let embedUrl = '';
            try {
                if (videoUrl.includes('youtube.com/watch?v=')) {
                    const videoId = videoUrl.split('v=')[1].split('&')[0];
                    embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=0&rel=0&modestbranding=1`;
                } else if (videoUrl.includes('youtu.be/')) {
                    const videoId = videoUrl.split('youtu.be/')[1].split('?')[0];
                    embedUrl = `https://www.youtube.com/embed/${videoId}?autoplay=0&rel=0&modestbranding=1`;
                } else if (videoUrl.includes('youtube.com/embed/')) {
                    embedUrl = videoUrl + (videoUrl.includes('?') ? '&' : '?') + 'autoplay=0&rel=0&modestbranding=1';
                } else {
                    // ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà YouTube URL ‡πÉ‡∏´‡πâ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ô‡πÅ‡∏ó‡πá‡∏ö‡πÉ‡∏´‡∏°‡πà
                    window.open(videoUrl, '_blank');
                    return;
                }

                player.src = embedUrl;
                modal.style.display = 'block';

                // ‡πÄ‡∏û‡∏¥‡πà‡∏° class ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö mobile
                document.body.classList.add('modal-open');

            } catch (error) {
                console.error('Error opening video:', error);
                window.open(videoUrl, '_blank');
            }
        }

        function playVideoReview(videoUrl) {
            if (videoUrl && videoUrl.trim()) {
                // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£ reload ‡∏´‡∏ô‡πâ‡∏≤
                if (event) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                openVideoModal(videoUrl);
            }
            return false;
        }

        function closeVideoModal() {
            const modal = document.getElementById('videoModal');
            const player = document.getElementById('youtubePlayer');

            if (modal) {
                modal.style.display = 'none';
            }
            if (player) {
                player.src = ''; // ‡∏´‡∏¢‡∏∏‡∏î‡πÄ‡∏•‡πà‡∏ô‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠
            }

            // ‡∏•‡∏ö class ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö mobile
            document.body.classList.remove('modal-open');
        }

        function expandContent(reviewId) {
            const contentDiv = document.querySelector(`[data-review-id="${reviewId}"] .content-preview`);
            const expandBtn = document.querySelector(`[data-review-id="${reviewId}"] .expand-btn`);

            // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏à‡∏≤‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
            const review = reviewsData.find(r => r.id === reviewId);
            if (review && contentDiv) {
                contentDiv.textContent = review.full_review_content;
                if (expandBtn) {
                    expandBtn.style.display = 'none';
                }
            }
        }

        // Event listeners
        window.onclick = function(event) {
            const imageModal = document.getElementById('imageModal');
            const videoModal = document.getElementById('videoModal');

            if (event.target === imageModal) {
                closeImageModal();
            }

            if (event.target === videoModal) {
                closeVideoModal();
            }
        }

        // ‡πÄ‡∏û‡∏¥‡πà‡∏° event listener ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö touch events ‡πÉ‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠
        document.addEventListener('touchstart', function(event) {
            const videoModal = document.getElementById('videoModal');
            const imageModal = document.getElementById('imageModal');

            if (event.target === videoModal) {
                closeVideoModal();
            }

            if (event.target === imageModal) {
                closeImageModal();
            }
        });

        // ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Å‡∏≤‡∏£ scroll ‡πÄ‡∏°‡∏∑‡πà‡∏≠ modal ‡πÄ‡∏õ‡∏¥‡∏î
        document.addEventListener('DOMContentLoaded', function() {
            const videoModal = document.getElementById('videoModal');
            const imageModal = document.getElementById('imageModal');

            if (videoModal) {
                videoModal.addEventListener('touchmove', function(e) {
                    e.preventDefault();
                }, { passive: false });
            }

            if (imageModal) {
                imageModal.addEventListener('touchmove', function(e) {
                    e.preventDefault();
                }, { passive: false });
            }
        });

        // Tab switching function
        function switchTab(tabName) {
            // Update active tab
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            event.target.closest('.nav-tab').classList.add('active');

            // Hide all sections
            document.getElementById('myBudsSection').style.display = 'none';
            document.getElementById('myReviewsSection').style.display = 'none';
            document.getElementById('friendsReviewsSection').style.display = 'none';

            // Show selected section
            currentTab = tabName;
            switch(tabName) {
                case 'myBuds':
                    document.getElementById('myBudsSection').style.display = 'block';
                    if (budsData.length === 0) loadBuds();
                    break;
                case 'myReviews':
                    document.getElementById('myReviewsSection').style.display = 'block';
                    if (reviewsData.length === 0) loadReviews();
                    break;
                case 'friendsReviews':
                    document.getElementById('friendsReviewsSection').style.display = 'block';
                    if (friendsReviewsData.length === 0) loadFriendsReviews();
                    break;
            }
        }

        // Load friends reviews data
        async function loadFriendsReviews() {
            if (isLoadingFriendsReviews) return;

            isLoadingFriendsReviews = true;
            const friendsReviewsList = document.getElementById('friendsReviewsList');

            try {
                friendsReviewsList.innerHTML = `
                    <div class="empty-state">
                        <div class="loading-spinner"></div>
                        <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏à‡∏≤‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô...</p>
                    </div>
                `;

                const response = await fetch('/api/friends_reviews');

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();

                if (data.error) {
                    throw new Error(data.error);
                }

                friendsReviewsData = data.reviews || [];
                displayFriendsReviews(friendsReviewsData);

            } catch (error) {
                console.error('Error loading friends reviews:', error);
                showFriendsReviewsError(error.message || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏à‡∏≤‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÑ‡∏î‡πâ');
            } finally {
                isLoadingFriendsReviews = false;
            }
        }

        function showFriendsReviewsError(message) {
            const friendsReviewsList = document.getElementById('friendsReviewsList');
            if (friendsReviewsList) {
                friendsReviewsList.innerHTML = `
                    <div class="error-message">
                        <div style="font-size: 48px; margin-bottom: 15px;">‚ùå</div>
                        <p>${message}</p>
                        <button class="retry-btn" onclick="loadFriendsReviews()">üîÑ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</button>
                    </div>
                `;
            }
        }

        function displayFriendsReviews(reviews) {
            const friendsReviewsList = document.getElementById('friendsReviewsList');

            if (reviews.length === 0) {
                friendsReviewsList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">üë•</div>
                        <p>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏à‡∏≤‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö</p>
                        <p style="font-size: 14px; color: #999;">‡πÄ‡∏ä‡∏¥‡∏ç‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏°‡∏≤‡∏£‡πà‡∏ß‡∏°‡πÅ‡∏ä‡∏£‡πå‡∏õ‡∏£‡∏∞‡∏™‡∏ö‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Å‡∏±‡∏ô</p>
                    </div>
                `;
                return;
            }

            // ‡πÉ‡∏ä‡πâ displayReviews function ‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô ‡πÅ‡∏ï‡πà‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô element ‡∏ó‡∏µ‡πà‡∏ï‡πà‡∏≤‡∏á‡∏Å‡∏±‡∏ô
            const reviewsHtml = reviews.map(review => {
                const createdDate = formatDate(review.created_at);
                const updatedDate = review.updated_at && review.updated_at !== review.created_at ? 
                    ` (‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î: ${formatDate(review.updated_at)})` : '';

                // ‡∏™‡∏£‡πâ‡∏≤‡∏á avatar ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Ñ‡∏ô‡∏£‡∏µ‡∏ß‡∏¥‡∏ß
                const reviewerAvatar = review.reviewer_profile_image ? 
                    `<img src="${review.reviewer_profile_image}" alt="Profile" class="reviewer-avatar-img">` :
                    (review.reviewer_name ? review.reviewer_name.charAt(0).toUpperCase() : 'üë§');

                // ‡∏™‡∏£‡πâ‡∏≤‡∏á effects tags
                const effectsTags = review.selected_effects && review.selected_effects.length > 0 ? 
                    review.selected_effects.slice(0, 4).map(effect => 
                        `<span class="effect-tag">${effect}</span>`
                    ).join('') + (review.selected_effects.length > 4 ? `<span class="more-tag">+${review.selected_effects.length - 4}</span>` : '') : '';

                // ‡∏™‡∏£‡πâ‡∏≤‡∏á aroma tags
                const aromaTags = review.aroma_flavors && review.aroma_flavors.length > 0 ? 
                    review.aroma_flavors.slice(0, 3).map(aroma => 
                        `<span class="aroma-tag">${aroma}</span>`
                    ).join('') + (review.aroma_flavors.length > 3 ? `<span class="more-tag">+${review.aroma_flavors.length - 3}</span>` : '') : '';

                // ‡∏™‡∏£‡πâ‡∏≤‡∏á review images
                const reviewImages = review.review_images && review.review_images.length > 0 ? 
                    `<div class="review-images-section">
                        <div class="review-images-grid">
                            ${review.review_images.slice(0, 4).map((img, index) => 
                                `<img src="${img}" alt="Review image ${index + 1}" class="review-image-thumb" onclick="viewImage('${img}')">`
                            ).join('')}
                            ${review.review_images.length > 4 ? `<div class="more-images">+${review.review_images.length - 4}</div>` : ''}
                        </div>
                    </div>` : '';

                return `
                    <div class="item-card" data-review-id="${review.id}">
                        <div class="review-content">
                            <div class="review-main-info">
                                <div class="item-header">
                                    <div class="item-name">
                                        ${review.strain_name_th || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ó‡∏¢'} (${review.strain_name_en || '‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©'}) - Bud ID: ${review.bud_reference_id}
                                    </div>
                                    <div class="item-date">${createdDate}${updatedDate}</div>
                                </div>

                                <div class="reviewer-info-section">
                                    <div class="reviewer-header">
                                        <div style="display: flex; align-items: center; gap: 8px; flex: 1;">
                                            <div class="reviewer-by-text">Review by :</div>
                                            <div class="reviewer-avatar-small">
                                                ${reviewerAvatar}
                                            </div>
                                            <div class="reviewer-name-display">${review.reviewer_name || '‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠'}</div>
                                        </div>
                                        <div style="margin-top: 4px; font-size: 12px; color: #FF9800; font-weight: 600;">
                                            <div>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏°: ${'‚≠ê'.repeat(review.overall_rating)} (${review.overall_rating}/5)</div>
                                            ${review.aroma_rating ? `<div>‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏Å‡∏•‡∏¥‡πà‡∏ô: ${'‚≠ê'.repeat(review.aroma_rating)} (${review.aroma_rating}/5)</div>` : ''}
                                        </div>
                                    </div>
                                </div>

                                <!-- ‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏µ‡∏ß‡∏¥‡∏ß -->
                                <div class="review-ratings-section">
                                    <div class="review-summary-text">${review.short_summary || '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏£‡∏∏‡∏õ'}</div>
                                </div>

                                <!-- Effects ‡πÅ‡∏•‡∏∞ Aromas -->
                                ${effectsTags ? `<div class="tags-section">
                                    <div class="tags-row">
                                        <span class="tags-label">üß† ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö:</span>
                                        <div class="tags-container">${effectsTags}</div>
                                    </div>
                                </div>` : ''}

                                ${aromaTags ? `<div class="tags-section">
                                    <div class="tags-row">
                                        <span class="tags-label">üëÉ ‡∏Å‡∏•‡∏¥‡πà‡∏ô/‡∏£‡∏™:</span>
                                        <div class="tags-container">${aromaTags}</div>
                                    </div>
                                </div>` : ''}

                                <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡πÄ‡∏ï‡πá‡∏° (‡∏¢‡πà‡∏≠) -->
                                ${review.full_review_content ? `<div class="review-full-content">
                                    <div class="content-preview">${review.full_review_content.length > 100 ? 
                                        review.full_review_content.substring(0, 100) + '...' : 
                                        review.full_review_content}</div>
                                    ${review.full_review_content.length > 100 ? 
                                        `<button class="expand-btn" onclick="expandContent(${review.id})">‡∏≠‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°</button>` : ''}
                                </div>` : ''}

                                <!-- ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏õ‡∏£‡∏∞‡∏Å‡∏≠‡∏ö‡∏Å‡∏≤‡∏£‡∏£‡∏µ‡∏ß‡∏¥‡∏ß ‡πÅ‡∏•‡∏∞‡∏õ‡∏∏‡πà‡∏°‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡∏£‡∏µ‡∏ß‡∏¥‡∏ß -->
                                <div class="review-media-section">
                                    ${reviewImages}
                                    ${review.video_review_url ? `
                                        <button class="video-review-btn" onclick="playVideoReview('${review.video_review_url}'); return false;" type="button">
                                            üé• ‡∏î‡∏π‡∏£‡∏µ‡∏ß‡∏¥‡∏ß
                                        </button>
                                    ` : ''}
                                </div>

                                <!-- ‡∏õ‡∏∏‡πà‡∏° Full Report -->
                                <div style="margin-top: 10px; text-align: left;">
                                    <a href="/bud-report?id=${review.bud_reference_id}" class="full-report-btn">
                                        üìä Full Report
                                    </a>
                                </div>

                            </div>
                        </div>
                    </div>
                `;
            }).join('');

            friendsReviewsList.innerHTML = reviewsHtml;
        }

        // Initialize when DOM is ready with improved performance
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM loaded, initializing...');

            // ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏ß‡πà‡∏≤ elements ‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
            const budsList = document.getElementById('budsList');
            const reviewsList = document.getElementById('reviewsList');

            if (budsList && reviewsList) {
                // ‡πÇ‡∏´‡∏•‡∏î‡∏ó‡∏±‡∏ô‡∏ó‡∏µ‡πÇ‡∏î‡∏¢‡πÑ‡∏°‡πà delay
                loadBuds();
            } else {
                console.error('Required elements not found');
            }
        });

        // Fallback for older browsers
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', function() {
                setTimeout(() => {
                    loadBuds();
                    loadReviews();
                }, 200);
            });
        } else {
            // DOM already loaded
            setTimeout(() => {
                loadBuds();
                loadReviews();
            }, 100);
        }
    </script>
</body>
</html>