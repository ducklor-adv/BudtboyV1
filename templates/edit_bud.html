<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, relevant=device-width, initial-scale=1.0">
    <title>‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏≠‡∏Å - Cannabis App</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #e8f5e8 0%, #f0f8ff 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #FF8C00, #FF7F50);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .back-btn {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .back-btn:hover {
            background: rgba(255,255,255,0.3);
            transform: translateY(-2px);
        }

        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }

        .loading-state {
            text-align: center;
            padding: 60px 20px;
            color: #666;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #FF8C00;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error-state {
            text-align: center;
            padding: 60px 20px;
            color: #d32f2f;
        }

        .error-state h3 {
            margin-bottom: 15px;
            font-size: 20px;
        }

        .retry-btn {
            background: #FF8C00;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            margin-top: 15px;
            transition: all 0.3s ease;
        }

        .retry-btn:hover {
            background: #e67e00;
            transform: translateY(-2px);
        }

        .form-content {
            padding: 40px;
            display: none;
        }

        .form-section {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 30px;
            margin-bottom: 30px;
            border-left: 5px solid #FF8C00;
        }

        .section-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #2c5530;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .form-row {
            display: flex;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .form-group {
            flex: 1;
            min-width: 250px;
        }

        .form-group.full-width {
            flex: 100%;
        }

        .form-group.half-width {
            flex: 1;
            min-width: 200px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #495057;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            box-sizing: border-box;
        }

        input:focus, select:focus, textarea:focus {
            outline: none;
            border-color: #FF8C00;
        }

        .required {
            color: #dc3545;
        }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            text-decoration: none;
            display: inline-block;
            text-align: center;
            transition: all 0.3s ease;
            margin: 8px 5px;
        }

        .btn-primary {
            background: #FF8C00;
            color: white;
        }

        .btn-primary:hover {
            background: #e67e00;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .form-actions {
            text-align: center;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e9ecef;
        }

        .alert {
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 8px;
            font-weight: 500;
        }

        .alert-success {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .alert-error {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .help-text {
            font-size: 14px;
            color: #6c757d;
            margin-top: 5px;
            font-style: italic;
        }

        /* Autocomplete Styles */
        .autocomplete-container {
            position: relative;
        }

        .suggestions-list {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 2px solid #e9ecef;
            border-top: none;
            border-radius: 0 0 8px 8px;
            max-height: 200px;
            overflow-y: auto;
            z-index: 1000;
            display: none;
        }

        .suggestion-item {
            padding: 12px;
            cursor: pointer;
            border-bottom: 1px solid #f8f9fa;
            transition: background-color 0.2s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .suggestion-item:hover {
            background-color: #f8f9fa;
        }

        .suggestion-item.selected {
            background-color: #FF8C00;
            color: white;
        }

        .suggestion-main {
            font-weight: 500;
        }

        .suggestion-meta {
            font-size: 12px;
            color: #6c757d;
            display: flex;
            gap: 8px;
        }

        .suggestion-item.selected .suggestion-meta {
            color: rgba(255, 255, 255, 0.8);
        }

        .popular-badge {
            background: #ffc107;
            color: #212529;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
            font-weight: bold;
        }

        .strain-type-badge {
            background: #6f42c1;
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 10px;
        }

        .no-suggestions {
            padding: 12px;
            text-align: center;
            color: #6c757d;
            font-style: italic;
        }

        /* Flavor Selector Styles */
        .aroma-selector {
            width: 100%;
        }

        .selected-flavors {
            min-height: 30px;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 5px;
            background: white;
            cursor: pointer;
            margin-bottom: 8px;
            display: flex;
            flex-wrap: wrap;
            gap: 3px;
            align-items: center;
        }

        .selected-flavors:hover {
            border-color: #FF8C00;
        }

        .selected-flavors .placeholder {
            color: #6c757d;
            font-style: italic;
        }

        .flavor-tag {
            background: #FF8C00;
            color: white;
            padding: 3px 6px;
            border-radius: 12px;
            font-size: 11px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .flavor-tag .remove-btn {
            background: rgba(255, 255, 255, 0.3);
            border: none;
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            font-size: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .flavor-tag .remove-btn:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        .flavor-categories {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 10px;
            max-height: 250px;
            overflow-y: auto;
            display: none;
        }

        .flavor-categories.active {
            display: block;
        }

        .flavor-category {
            margin-bottom: 12px;
        }

        .category-title {
            font-weight: 600;
            color: #2c5530;
            margin-bottom: 8px;
            padding-bottom: 4px;
            border-bottom: 1px solid #e9ecef;
            font-size: 13px;
        }

        .flavor-options {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }

        .flavor-btn {
            background: white;
            border: 1px solid #e9ecef;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #495057;
        }

        .flavor-btn:hover {
            background: #e8f5e8;
            border-color: #FF8C00;
            color: #2c5530;
        }

        .flavor-btn.selected {
            background: #FF8C00;
            border-color: #FF8C00;
            color: white;
        }

        .clear-all-btn {
            background: #dc3545;
            color: white;
            border: none;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            cursor: pointer;
            margin-left: 10px;
        }

        .clear-all-btn:hover {
            background: #c82333;
        }

        /* Effects Two-Column Layout */
        .effects-two-columns {
            display: flex;
            gap: 30px;
            margin-bottom: 20px;
        }

        .effects-column {
            flex: 1;
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            border: 1px solid #e9ecef;
        }

        .column-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #2c5530;
            margin-bottom: 20px;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid #FF8C00;
        }

        /* Effects Selector Styles */
        .effects-selector {
            width: 100%;
            margin-bottom: 20px;
        }

        .selected-effects {
            min-height: 30px;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 5px;
            background: white;
            cursor: pointer;
            margin-bottom: 8px;
            display: flex;
            flex-wrap: wrap;
            gap: 3px;
            align-items: center;
        }

        .selected-effects:hover {
            border-color: #FF8C00;
        }

        .selected-effects .placeholder {
            color: #6c757d;
            font-style: italic;
        }

        .effect-tag {
            background: #FF8C00;
            color: white;
            padding: 3px 6px;
            border-radius: 12px;
            font-size: 11px;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .effect-tag.negative {
            background: #dc3545;
        }

        .effect-tag .remove-btn {
            background: rgba(255, 255, 255, 0.3);
            border: none;
            color: white;
            border-radius: 50%;
            width: 16px;
            height: 16px;
            font-size: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .effect-tag .remove-btn:hover {
            background: rgba(255, 255, 255, 0.5);
        }

        .effects-categories {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 5px;
            padding: 10px;
            max-height: 250px;
            overflow-y: auto;
            display: none;
        }

        .effects-categories.active {
            display: block;
        }

        .effect-category {
            margin-bottom: 12px;
        }

        .effect-options {
            display: flex;
            flex-wrap: wrap;
            gap: 4px;
        }

        .effect-btn {
            background: white;
            border: 1px solid #e9ecef;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.2s ease;
            color: #495057;
        }

        .effect-btn:hover {
            background: #e8f5e8;
            border-color: #FF8C00;
            color: #2c5530;
        }

        .effect-btn.selected {
            background: #FF8C00;
            border-color: #FF8C00;
            color: white;
        }

        .effect-btn.negative {
            background: white;
            border: 1px solid #e9ecef;
            color: #dc3545;
        }

        .effect-btn.negative:hover {
            background: #fdedee;
            border-color: #dc3545;
            color: #a71d2a;
        }

        .effect-btn.negative.selected {
            background: #dc3545;
            border-color: #dc3545;
            color: white;
        }

        /* Current Image Display */
        .current-image {
            position: relative;
            width: 100%;
            height: 120px;
            border-radius: 8px;
            overflow: hidden;
            border: 2px solid #28a745;
            background: #f8f9fa;
        }

        .current-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            cursor: pointer;
        }

        .current-image:hover {
            border-color: #1e7e34;
        }

        .replace-image-btn {
            position: absolute;
            top: 5px;
            left: 5px;
            background: rgba(0, 123, 255, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            font-size: 12px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s ease;
        }

        .replace-image-btn:hover {
            background: rgba(0, 86, 179, 1);
        }

        /* Image Upload Styles */
        .image-upload-section {
            margin-top: 15px;
        }

        .image-upload-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }

        .image-upload-item {
            position: relative;
            border-radius: 8px;
            overflow: hidden;
        }

        .upload-label {
            display: block;
            width: 100%;
            height: 120px;
            border: 2px dashed #e9ecef;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }

        .upload-label:hover {
            border-color: #FF8C00;
            background: #fff5e6;
        }

        .upload-placeholder {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100%;
            color: #6c757d;
        }

        .upload-icon {
            font-size: 24px;
            margin-bottom: 8px;
        }

        .upload-text {
            font-size: 14px;
            font-weight: 500;
        }

        .image-preview {
            position: relative;
            width: 100%;
            height: 120px;
            border-radius: 8px;
            overflow: hidden;
            border: 2px solid #FF8C00;
        }

        .image-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .remove-image-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            background: rgba(220, 53, 69, 0.9);
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            font-size: 16px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: background 0.3s ease;
        }

        .remove-image-btn:hover {
            background: rgba(220, 53, 69, 1);
        }

        .upload-actions {
            text-align: center;
            margin-top: 15px;
        }

        /* Simplified Terpene Styles */
        .terpenes-simple-container {
            width: 100%;
            margin-bottom: 20px;
        }

        /* Terpene Selection Grid Styles */
        .terpene-selection-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 20px;
        }

        .terpene-column {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .terpene-column label {
            font-size: 14px;
            font-weight: 600;
            color: #2c5530;
            margin-bottom: 5px;
            text-align: center;
        }

        .terpene-select {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 13px;
            background: white;
            color: #495057;
            transition: border-color 0.3s ease;
            min-height: 42px;
        }

        .terpene-select:focus {
            outline: none;
            border-color: #FF8C00;
        }

        .terpene-select option {
            padding: 8px;
            font-size: 13px;
            line-height: 1.4;
        }

        .terpene-column input[type="number"] {
            padding: 10px 12px;
            border: 2px solid #e9ecef;
            border-radius: 6px;
            font-size: 14px;
            text-align: center;
            transition: border-color 0.3s ease;
        }

        .terpene-column input[type="number"]:focus {
            outline: none;
            border-color: #FF8C00;
        }

        /* Effects Table Styles */
        .effects-table-container {
            width: 100%;
            overflow-x: auto;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
            }

            .form-group {
                min-width: auto;
            }

            .container {
                margin: 10px;
            }

            .form-content {
                padding: 15px;
            }

            .header {
                padding: 15px;
            }

            .header h1 {
                font-size: 1.5em;
            }

            .form-section {
                padding: 15px;
                margin-bottom: 15px;
            }

            .effects-two-columns {
                flex-direction: column;
                gap: 20px;
            }

            .effects-column {
                padding: 15px;
            }

            .column-title {
                font-size: 1.1em;
                margin-bottom: 15px;
            }

            .terpene-selection-grid {
                grid-template-columns: 1fr;
                gap: 15px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <a href="/activity" class="back-btn">‚Üê ‡∏Å‡∏•‡∏±‡∏ö</a>
            <div style="display: flex; align-items: center; justify-content: center; gap: 15px;">
                <h1>üåø ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏≠‡∏Å</h1>
            </div>
        </div>

        <div id="loadingState" class="loading-state">
            <div class="loading-spinner"></div>
            <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
        </div>

        <div id="errorState" class="error-state" style="display: none;">
            <h3>‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î</h3>
            <p id="errorMessage">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ</p>
            <button class="retry-btn" onclick="retryLoadBud()">üîÑ ‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà</button>
        </div>

        <div id="formContainer" class="form-content">
            <div id="alertContainer"></div>

            <form id="editBudForm">
                <!-- Basic Information -->
                <div class="form-section">
                    <div class="section-title">
                        üìã ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="strain_name_en">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå (‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©) <span class="required">*</span></label>
                            <div class="autocomplete-container">
                                <input type="text" id="strain_name_en" name="strain_name_en" 
                                       placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏†‡∏≤‡∏©‡∏≤‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©..." required
                                       autocomplete="off">
                                <div id="suggestions_en" class="suggestions-list"></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="strain_name_th">‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå (‡πÑ‡∏ó‡∏¢)</label>
                            <div class="autocomplete-container">
                                <input type="text" id="strain_name_th" name="strain_name_th" 
                                       placeholder="‡∏û‡∏¥‡∏°‡∏û‡πå‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏†‡∏≤‡∏©‡∏≤‡πÑ‡∏ó‡∏¢..."
                                       autocomplete="off">
                                <div id="suggestions_th" class="suggestions-list"></div>
                            </div>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="breeder">‡∏ú‡∏π‡πâ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡∏™‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå</label>
                            <div class="autocomplete-container">
                                <input type="text" id="breeder" name="breeder" placeholder="‡πÄ‡∏ä‡πà‡∏ô DNA Genetics, Barney's Farm" autocomplete="off">
                                <div id="breeder-suggestions" class="suggestions-list"></div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="strain_type">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏™‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå <span class="required">*</span></label>
                            <select id="strain_type" name="strain_type" required>
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option>
                                <option value="Indica">Indica</option>
                                <option value="Sativa">Sativa</option>
                                <option value="Hybrid">Hybrid</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Chemical Properties -->
                <div class="form-section">
                    <div class="section-title">
                        üß™ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏≤‡∏á‡πÄ‡∏Ñ‡∏°‡∏µ
                    </div>

                    <div class="form-row">
                        <div class="form-group half-width">
                            <label for="thc_percentage">THC (%)</label>
                            <input type="number" id="thc_percentage" name="thc_percentage" step="0.01" min="0" max="100">
                            <div class="help-text">‡∏£‡∏∞‡∏î‡∏±‡∏ö THC ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå</div>
                        </div>
                        <div class="form-group half-width">
                            <label for="cbd_percentage">CBD (%)</label>
                            <input type="number" id="cbd_percentage" name="cbd_percentage" step="0.01" min="0" max="100">
                            <div class="help-text">‡∏£‡∏∞‡∏î‡∏±‡∏ö CBD ‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏õ‡∏≠‡∏£‡πå‡πÄ‡∏ã‡πá‡∏ô‡∏ï‡πå</div>
                        </div>
                        <div class="form-group half-width">
                            <label for="grade">‡πÄ‡∏Å‡∏£‡∏î</label>
                            <select id="grade" name="grade">
                                <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏Å‡∏£‡∏î</option>
                                <option value="A+">A+</option>
                                <option value="A">A</option>
                                <option value="B+">B+</option>
                                <option value="B">B</option>
                                <option value="C">C</option>
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Certificate Information -->
                <div class="form-section">
                    <div class="section-title">
                        üèÜ ‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á (Certificate)
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="lab_test_name">Lab test (‡∏ä‡∏∑‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏ß‡∏à)</label>
                            <input type="text" id="lab_test_name" name="lab_test_name" placeholder="‡πÄ‡∏ä‡πà‡∏ô Cannabis Testing Lab, Green Lab Thailand">
                            <div class="help-text">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡πâ‡∏≠‡∏á‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏´‡∏£‡∏∑‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</div>
                        </div>
                        <div class="form-group">
                            <label for="test_type">Test type (‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à)</label>
                            <input type="text" id="test_type" name="test_type" placeholder="‡πÄ‡∏ä‡πà‡∏ô HPLC, GC-MS, LC-MS/MS">
                            <div class="help-text">‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</div>
                        </div>
                    </div>

                    <!-- Image Management Section -->
                    <div class="image-upload-section">
                        <p class="help-text">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 4 ‡∏£‡∏π‡∏õ, ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 16MB ‡∏ï‡πà‡∏≠‡∏£‡∏π‡∏õ)</p>

                        <div class="image-upload-grid">
                            <div class="image-upload-item">
                                <label for="certificate_image_1" class="upload-label">
                                    <div class="upload-placeholder">
                                        <span class="upload-icon">üì∑</span>
                                        <span class="upload-text">‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 1</span>
                                    </div>
                                </label>
                                <input type="file" id="certificate_image_1" name="certificate_image_1" accept="image/*" style="display: none;">
                                <div class="image-preview" id="certificate_preview_1" style="display: none;">
                                    <img src="" alt="Preview">
                                    <button type="button" class="remove-image-btn" onclick="removeCertificateImage(1)">√ó</button>
                                </div>
                                <div class="current-image" id="current_certificate_1" style="display: none;">
                                    <img src="" alt="Current Image">
                                    <button type="button" class="remove-image-btn" onclick="removeCurrentCertificateImage(1)">√ó</button>
                                    <button type="button" class="replace-image-btn" onclick="replaceCurrentCertificateImage(1)">üîÑ</button>
                                </div>
                            </div>

                            <div class="image-upload-item">
                                <label for="certificate_image_2" class="upload-label">
                                    <div class="upload-placeholder">
                                        <span class="upload-icon">üì∑</span>
                                        <span class="upload-text">‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 2</span>
                                    </div>
                                </label>
                                <input type="file" id="certificate_image_2" name="certificate_image_2" accept="image/*" style="display: none;">
                                <div class="image-preview" id="certificate_preview_2" style="display: none;">
                                    <img src="" alt="Preview">
                                    <button type="button" class="remove-image-btn" onclick="removeCertificateImage(2)">√ó</button>
                                </div>
                                <div class="current-image" id="current_certificate_2" style="display: none;">
                                    <img src="" alt="Current Image">
                                    <button type="button" class="remove-image-btn" onclick="removeCurrentCertificateImage(2)">√ó</button>
                                    <button type="button" class="replace-image-btn" onclick="replaceCurrentCertificateImage(2)">üîÑ</button>
                                </div>
                            </div>

                            <div class="image-upload-item">
                                <label for="certificate_image_3" class="upload-label">
                                    <div class="upload-placeholder">
                                        <span class="upload-icon">üì∑</span>
                                        <span class="upload-text">‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 3</span>
                                    </div>
                                </label>
                                <input type="file" id="certificate_image_3" name="certificate_image_3" accept="image/*" style="display: none;">
                                <div class="image-preview" id="certificate_preview_3" style="display: none;">
                                    <img src="" alt="Preview">
                                    <button type="button" class="remove-image-btn" onclick="removeCertificateImage(3)">√ó</button>
                                </div>
                                <div class="current-image" id="current_certificate_3" style="display: none;">
                                    <img src="" alt="Current Image">
                                    <button type="button" class="remove-image-btn" onclick="removeCurrentCertificateImage(3)">√ó</button>
                                    <button type="button" class="replace-image-btn" onclick="replaceCurrentCertificateImage(3)">üîÑ</button>
                                </div>
                            </div>

                            <div class="image-upload-item">
                                <label for="certificate_image_4" class="upload-label">
                                    <div class="upload-placeholder">
                                        <span class="upload-icon">üì∑</span>
                                        <span class="upload-text">‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 4</span>
                                    </div>
                                </label>
                                <input type="file" id="certificate_image_4" name="certificate_image_4" accept="image/*" style="display: none;">
                                <div class="image-preview" id="certificate_preview_4" style="display: none;">
                                    <img src="" alt="Preview">
                                    <button type="button" class="remove-image-btn" onclick="removeCertificateImage(4)">√ó</button>
                                </div>
                                <div class="current-image" id="current_certificate_4" style="display: none;">
                                    <img src="" alt="Current Image">
                                    <button type="button" class="remove-image-btn" onclick="removeCurrentCertificateImage(4)">√ó</button>
                                    <button type="button" class="replace-image-btn" onclick="replaceCurrentCertificateImage(4)">üîÑ</button>
                                </div>
                            </div>
                        </div>

                        <div class="upload-actions">
                            <button type="button" id="clearAllCertificateImagesBtn" class="btn btn-secondary" onclick="clearAllCertificateImages()">
                                üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏π‡∏õ‡πÉ‡∏ö‡∏£‡∏±‡∏ö‡∏£‡∏≠‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Sensory Properties -->
                <div class="form-section">
                    <div class="section-title">
                        üëÉ ‡∏Ñ‡∏∏‡∏ì‡∏™‡∏°‡∏ö‡∏±‡∏ï‡∏¥‡∏ó‡∏≤‡∏á‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ó‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™
                    </div>

                    <div class="form-row">
                        <div class="form-group full-width">
                            <label for="aroma_flavor">‡∏Å‡∏•‡∏¥‡πà‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏™ (‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏≤‡∏¢‡∏ï‡∏±‡∏ß)</label>
                            <div class="aroma-selector">
                                <!-- Selected flavors display -->
                                <div id="selected-flavors" class="selected-flavors">
                                    <span class="placeholder">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏¥‡πà‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏™...</span>
                                </div>

                                <!-- Hidden input to store selected values -->
                                <textarea id="aroma_flavor" name="aroma_flavor" style="display: none;"></textarea>

                                <!-- Flavor categories -->
                                <div class="flavor-categories">
                                    <div class="flavor-category">
                                        <div class="category-title">üçä ‡∏ú‡∏•‡πÑ‡∏°‡πâ</div>
                                        <div class="flavor-options">
                                            <button type="button" class="flavor-btn" data-flavor="‡πÄ‡∏•‡∏°‡∏≠‡∏ô">‡πÄ‡∏•‡∏°‡∏≠‡∏ô</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏™‡πâ‡∏°">‡∏™‡πâ‡∏°</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏°‡∏∞‡∏ô‡∏≤‡∏ß">‡∏°‡∏∞‡∏ô‡∏≤‡∏ß</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡πÄ‡∏Å‡∏£‡∏õ‡∏ü‡∏£‡∏∏‡∏ï">‡πÄ‡∏Å‡∏£‡∏õ‡∏ü‡∏£‡∏∏‡∏ï</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏™‡∏ï‡∏£‡∏≠‡∏ß‡πå‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà">‡∏™‡∏ï‡∏£‡∏≠‡∏ß‡πå‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏ö‡∏•‡∏π‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà">‡∏ö‡∏•‡∏π‡πÄ‡∏ö‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡πÄ‡∏ä‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà">‡πÄ‡∏ä‡∏≠‡∏£‡πå‡∏£‡∏µ‡πà</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏≠‡∏á‡∏∏‡πà‡∏ô">‡∏≠‡∏á‡∏∏‡πà‡∏ô</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡πÅ‡∏≠‡∏õ‡πÄ‡∏õ‡∏¥‡πâ‡∏•">‡πÅ‡∏≠‡∏õ‡πÄ‡∏õ‡∏¥‡πâ‡∏•</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á">‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î">‡∏™‡∏±‡∏ö‡∏õ‡∏∞‡∏£‡∏î</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏Å‡∏•‡πâ‡∏ß‡∏¢">‡∏Å‡∏•‡πâ‡∏ß‡∏¢</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏û‡∏µ‡∏ä">‡∏û‡∏µ‡∏ä</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡πÅ‡∏ï‡∏á‡πÇ‡∏°">‡πÅ‡∏ï‡∏á‡πÇ‡∏°</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏Å‡∏µ‡∏ß‡∏µ">‡∏Å‡∏µ‡∏ß‡∏µ</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß">‡∏°‡∏∞‡∏û‡∏£‡πâ‡∏≤‡∏ß</button>
                                        </div>
                                    </div>

                                    <div class="flavor-category">
                                        <div class="category-title">üç∞ ‡∏´‡∏ß‡∏≤‡∏ô‚Äë‡∏Ç‡∏ô‡∏°</div>
                                        <div class="flavor-options">
                                            <button type="button" class="flavor-btn" data-flavor="‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á">‡∏ô‡πâ‡∏≥‡∏ú‡∏∂‡πâ‡∏á</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏ß‡∏ô‡∏¥‡∏•‡∏≤">‡∏ß‡∏ô‡∏¥‡∏•‡∏≤</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏Ñ‡∏≤‡∏£‡∏≤‡πÄ‡∏°‡∏•">‡∏Ñ‡∏≤‡∏£‡∏≤‡πÄ‡∏°‡∏•</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å">‡∏ä‡πá‡∏≠‡∏Å‡πÇ‡∏Å</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏Å‡∏≤‡πÅ‡∏ü">‡∏Å‡∏≤‡πÅ‡∏ü</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡πÄ‡∏Ñ‡πâ‡∏Å">‡πÄ‡∏Ñ‡πâ‡∏Å</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏Ñ‡∏∏‡∏Å‡∏Å‡∏µ‡πâ">‡∏Ñ‡∏∏‡∏Å‡∏Å‡∏µ‡πâ</button>
                                        </div>
                                    </div>

                                    <div class="flavor-category">
                                        <div class="category-title">ü•õ ‡∏Ñ‡∏£‡∏µ‡∏°‚Äë‡∏ô‡∏°</div>
                                        <div class="flavor-options">
                                            <button type="button" class="flavor-btn" data-flavor="‡∏Ñ‡∏£‡∏µ‡∏°">‡∏Ñ‡∏£‡∏µ‡∏°</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏ö‡∏±‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå">‡∏ö‡∏±‡∏ï‡πÄ‡∏ï‡∏≠‡∏£‡πå</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏ä‡∏µ‡∏™">‡∏ä‡∏µ‡∏™</button>
                                        </div>
                                    </div>

                                    <div class="flavor-category">
                                        <div class="category-title">ü•ú ‡∏ñ‡∏±‡πà‡∏ß‚Äë‡πÄ‡∏°‡∏•‡πá‡∏î</div>
                                        <div class="flavor-options">
                                            <button type="button" class="flavor-btn" data-flavor="‡∏ñ‡∏±‡πà‡∏ß">‡∏ñ‡∏±‡πà‡∏ß</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏≠‡∏±‡∏•‡∏°‡∏≠‡∏ô‡∏î‡πå">‡∏≠‡∏±‡∏•‡∏°‡∏≠‡∏ô‡∏î‡πå</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏ß‡∏≠‡∏•‡∏ô‡∏±‡∏ó">‡∏ß‡∏≠‡∏•‡∏ô‡∏±‡∏ó</button>
                                        </div>
                                    </div>

                                    <div class="flavor-category">
                                        <div class="category-title">üåø ‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£‚Äë‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÄ‡∏ó‡∏®</div>
                                        <div class="flavor-options">
                                            <button type="button" class="flavor-btn" data-flavor="‡∏û‡∏£‡∏¥‡∏Å‡πÑ‡∏ó‡∏¢">‡∏û‡∏£‡∏¥‡∏Å‡πÑ‡∏ó‡∏¢</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏≠‡∏ö‡πÄ‡∏ä‡∏¢">‡∏≠‡∏ö‡πÄ‡∏ä‡∏¢</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏à‡∏±‡∏ô‡∏ó‡∏ô‡πå‡πÄ‡∏ó‡∏®">‡∏à‡∏±‡∏ô‡∏ó‡∏ô‡πå‡πÄ‡∏ó‡∏®</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏Ç‡∏¥‡∏á">‡∏Ç‡∏¥‡∏á</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏Å‡∏≤‡∏ô‡∏û‡∏•‡∏π">‡∏Å‡∏≤‡∏ô‡∏û‡∏•‡∏π</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏¢‡∏µ‡πà‡∏´‡∏£‡πà‡∏≤">‡∏¢‡∏µ‡πà‡∏´‡∏£‡πà‡∏≤</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏Æ‡πá‡∏≠‡∏õ‡∏™‡πå">‡∏Æ‡πá‡∏≠‡∏õ‡∏™‡πå</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏°‡∏¥‡πâ‡∏ô‡∏ï‡πå">‡∏°‡∏¥‡πâ‡∏ô‡∏ï‡πå</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡πÇ‡∏£‡∏™‡πÅ‡∏°‡∏£‡∏µ‡πà">‡πÇ‡∏£‡∏™‡πÅ‡∏°‡∏£‡∏µ‡πà</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡πÑ‡∏ó‡∏°‡πå">‡πÑ‡∏ó‡∏°‡πå</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡πÄ‡∏™‡∏à">‡πÄ‡∏™‡∏à</button>
                                        </div>
                                    </div>

                                    <div class="flavor-category">
                                        <div class="category-title">üå∏ ‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ</div>
                                        <div class="flavor-options">
                                            <button type="button" class="flavor-btn" data-flavor="‡∏Å‡∏∏‡∏´‡∏•‡∏≤‡∏ö">‡∏Å‡∏∏‡∏´‡∏•‡∏≤‡∏ö</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏•‡∏≤‡πÄ‡∏ß‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå">‡∏•‡∏≤‡πÄ‡∏ß‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏°‡∏∞‡∏•‡∏¥">‡∏°‡∏∞‡∏•‡∏¥</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏î‡∏≠‡∏Å‡∏™‡πâ‡∏°">‡∏î‡∏≠‡∏Å‡∏™‡πâ‡∏°</button>
                                        </div>
                                    </div>

                                    <div class="flavor-category">
                                        <div class="category-title">üå≤ ‡πÑ‡∏°‡πâ‚Äë‡∏î‡∏¥‡∏ô</div>
                                        <div class="flavor-options">
                                            <button type="button" class="flavor-btn" data-flavor="‡πÑ‡∏°‡πâ‡∏™‡∏ô">‡πÑ‡∏°‡πâ‡∏™‡∏ô</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡πÑ‡∏°‡πâ‡∏ã‡∏µ‡∏î‡∏≤‡∏£‡πå">‡πÑ‡∏°‡πâ‡∏ã‡∏µ‡∏î‡∏≤‡∏£‡πå</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡πÑ‡∏°‡πâ‡∏à‡∏±‡∏ô‡∏ó‡∏ô‡πå">‡πÑ‡∏°‡πâ‡∏à‡∏±‡∏ô‡∏ó‡∏ô‡πå</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡πÄ‡∏£‡∏ã‡∏¥‡∏ô">‡πÄ‡∏£‡∏ã‡∏¥‡∏ô</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏î‡∏¥‡∏ô">‡∏î‡∏¥‡∏ô</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏´‡∏ç‡πâ‡∏≤">‡∏´‡∏ç‡πâ‡∏≤</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏°‡∏±‡∏™‡∏Å‡πå">‡∏°‡∏±‡∏™‡∏Å‡πå</button>
                                        </div>
                                    </div>

                                    <div class="flavor-category">
                                        <div class="category-title">‚õΩ ‡πÅ‡∏Å‡πä‡∏™‚Äë‡πÄ‡∏Ñ‡∏°‡∏µ</div>
                                        <div class="flavor-options">
                                            <button type="button" class="flavor-btn" data-flavor="‡∏î‡∏µ‡πÄ‡∏ã‡∏•">‡∏î‡∏µ‡πÄ‡∏ã‡∏•</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô">‡∏ô‡πâ‡∏≥‡∏°‡∏±‡∏ô</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡πÅ‡∏Å‡πä‡∏™">‡πÅ‡∏Å‡πä‡∏™</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏™‡∏Å‡∏±‡∏á‡∏Å‡πå">‡∏™‡∏Å‡∏±‡∏á‡∏Å‡πå</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡πÅ‡∏≠‡∏°‡πÇ‡∏°‡πÄ‡∏ô‡∏µ‡∏¢">‡πÅ‡∏≠‡∏°‡πÇ‡∏°‡πÄ‡∏ô‡∏µ‡∏¢</button>
                                            <button type="button" class="flavor-btn" data-flavor="‡∏¢‡∏≤‡∏á">‡∏¢‡∏≤‡∏á</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Simplified Terpenes Container -->
                    <div class="terpenes-simple-container">
                        <!-- Tab Headers -->
                        <div class="tab-headers">
                            <button type="button" class="tab-header active" data-tab="terpene-1">Terpene ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 1</button>
                            <button type="button" class="tab-header" data-tab="terpene-2">Terpene ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 2</button>
                            <button type="button" class="tab-header" data-tab="terpene-3">Terpene ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 3</button>
                        </div>

                        <!-- Display Selected Terpenes Row -->
                        <div class="terpene-display-row">
                            <div class="terpene-rank-display">
                                <div class="terpene-rank-value" id="display-terpene-1">
                                    <span class="placeholder">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏</span>
                                </div>
                            </div>
                            <div class="terpene-rank-display">
                                <div class="terpene-rank-value" id="display-terpene-2">
                                    <span class="placeholder">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏</span>
                                </div>
                            </div>
                            <div class="terpene-rank-display">
                                <div class="terpene-rank-value" id="display-terpene-3">
                                    <span class="placeholder">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏</span>
                                </div>
                            </div>
                        </div>

                        <!-- Terpene Selection Grid -->
                        <div class="terpene-selection-grid">
                            <div class="terpene-column">
                                <label for="terpene_1_select">Terpene ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 1</label>
                                <select id="terpene_1_select" class="terpene-select">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Terpene ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 1</option>
                                    <option value="‡πÑ‡∏°‡∏£‡πå‡∏ã‡∏µ‡∏ô (Myrcene)">‡πÑ‡∏°‡∏£‡πå‡∏ã‡∏µ‡∏ô (Myrcene) - ‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á/‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£ ‚Üí ‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢, ‡∏á‡πà‡∏ß‡∏á</option>
                                    <option value="‡∏•‡∏¥‡πÇ‡∏°‡∏ô‡∏µ‡∏ô (Limonene)">‡∏•‡∏¥‡πÇ‡∏°‡∏ô‡∏µ‡∏ô (Limonene) - ‡∏™‡πâ‡∏°/‡πÄ‡∏•‡∏°‡∏≠‡∏ô ‚Üí ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏î‡∏µ, ‡∏ï‡πâ‡∏≤‡∏ô‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î</option>
                                    <option value="‡πÄ‡∏ö‡∏ï‡∏≤‚Äë‡∏Ñ‡∏≤‡∏£‡∏¥‡πÇ‡∏≠‡∏ü‡∏µ‡∏•‡∏•‡∏µ‡∏ô (Œ≤‚ÄëCaryophyllene)">‡πÄ‡∏ö‡∏ï‡∏≤‚Äë‡∏Ñ‡∏≤‡∏£‡∏¥‡πÇ‡∏≠‡∏ü‡∏µ‡∏•‡∏•‡∏µ‡∏ô (Œ≤‚ÄëCaryophyllene) - ‡∏û‡∏£‡∏¥‡∏Å‡πÑ‡∏ó‡∏¢/‡πÄ‡∏ú‡πá‡∏î ‚Üí ‡∏ö‡∏£‡∏£‡πÄ‡∏ó‡∏≤‡∏õ‡∏ß‡∏î, ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö</option>
                                    <option value="‡∏•‡∏¥‡∏ô‡∏≤‡∏•‡∏π‡∏• (Linalool)">‡∏•‡∏¥‡∏ô‡∏≤‡∏•‡∏π‡∏• (Linalool) - ‡∏•‡∏≤‡πÄ‡∏ß‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå ‚Üí ‡∏Ñ‡∏•‡∏≤‡∏¢‡∏Å‡∏±‡∏á‡∏ß‡∏•, ‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏•‡∏±‡∏ö</option>
                                    <option value="‡πÅ‡∏≠‡∏•‡∏ü‡∏≤‚Äë‡πÑ‡∏û‡∏ô‡∏µ‡∏ô (Œ±‚ÄëPinene)">‡πÅ‡∏≠‡∏•‡∏ü‡∏≤‚Äë‡πÑ‡∏û‡∏ô‡∏µ‡∏ô (Œ±‚ÄëPinene) - ‡∏™‡∏ô ‚Üí ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏≠‡∏î, ‡∏ä‡πà‡∏ß‡∏¢‡πÇ‡∏ü‡∏Å‡∏±‡∏™</option>
                                    <option value="‡∏Æ‡∏¥‡∏ß‡∏°‡∏π‡πÄ‡∏•‡∏ô (Humulene)">‡∏Æ‡∏¥‡∏ß‡∏°‡∏π‡πÄ‡∏•‡∏ô (Humulene) - ‡∏Æ‡πá‡∏≠‡∏õ‡∏™‡πå/‡πÑ‡∏°‡πâ ‚Üí ‡∏•‡∏î‡∏≠‡∏¢‡∏≤‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£, ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö</option>
                                    <option value="‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡∏ô‡∏≠‡∏•‡∏µ‡∏ô (Terpinolene)">‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡∏ô‡∏≠‡∏•‡∏µ‡∏ô (Terpinolene) - ‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ/‡∏™‡∏ô‡∏´‡∏ß‡∏≤‡∏ô ‚Üí ‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡πÄ‡∏ö‡∏≤, ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏π‡∏•‡∏Ø</option>
                                    <option value="‡πÄ‡∏ö‡∏ï‡∏≤‚Äë‡πÑ‡∏û‡∏ô‡∏µ‡∏ô (Œ≤‚ÄëPinene)">‡πÄ‡∏ö‡∏ï‡∏≤‚Äë‡πÑ‡∏û‡∏ô‡∏µ‡∏ô (Œ≤‚ÄëPinene) - ‡πÇ‡∏£‡∏™‡πÅ‡∏°‡∏£‡∏µ‡πà ‚Üí ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö</option>
                                    <option value="‡πÇ‡∏≠‡∏ã‡∏¥‡∏°‡∏µ‡∏ô (Ocimene)">‡πÇ‡∏≠‡∏ã‡∏¥‡∏°‡∏µ‡∏ô (Ocimene) - ‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡∏´‡∏ß‡∏≤‡∏ô ‚Üí ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏´‡∏•‡∏≠‡∏î‡∏•‡∏°, ‡∏ï‡πâ‡∏≤‡∏ô‡πÑ‡∏ß‡∏£‡∏±‡∏™</option>
                                    <option value="‡∏Å‡∏±‡∏°‡∏°‡∏≤‚Äë‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡∏ô‡∏µ‡∏ô (Œ≥‚ÄëTerpinene)">‡∏Å‡∏±‡∏°‡∏°‡∏≤‚Äë‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡∏ô‡∏µ‡∏ô (Œ≥‚ÄëTerpinene) - ‡∏°‡∏∞‡∏ô‡∏≤‡∏ß/‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£ ‚Üí ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏π‡∏•‡∏Ø, ‡∏ï‡πâ‡∏≤‡∏ô‡∏à‡∏∏‡∏•‡∏ä‡∏µ‡∏û</option>
                                    <option value="‡πÄ‡∏ô‡πÇ‡∏£‡∏•‡∏¥‡∏î‡∏≠‡∏• (Nerolidol)">‡πÄ‡∏ô‡πÇ‡∏£‡∏•‡∏¥‡∏î‡∏≠‡∏• (Nerolidol) - ‡∏ä‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß/‡πÑ‡∏°‡πâ ‚Üí ‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠, ‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏•‡∏±‡∏ö</option>
                                    <option value="‡∏ö‡∏¥‡∏ã‡∏≤‡πÇ‡∏ö‡∏•‡∏≠‡∏• (Bisabolol)">‡∏ö‡∏¥‡∏ã‡∏≤‡πÇ‡∏ö‡∏•‡∏≠‡∏• (Bisabolol) - ‡∏Ñ‡∏≤‡πÇ‡∏°‡∏°‡∏≤‡∏¢‡∏•‡πå ‚Üí ‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á‡∏ú‡∏¥‡∏ß, ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö</option>
                                    <option value="‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡πÇ‡∏ô‡∏• (Terpineol)">‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡πÇ‡∏ô‡∏• (Terpineol) - ‡πÑ‡∏°‡πâ‡∏Ç‡∏≤‡∏ß/‡πÑ‡∏û‡∏ô‡πå‡∏´‡∏ß‡∏≤‡∏ô ‚Üí ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏á‡∏ö‡πÉ‡∏à, ‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢</option>
                                    <option value="‡∏ü‡∏≤‡∏£‡πå‡∏ô‡∏µ‡∏ã‡∏µ‡∏ô (Farnesene)">‡∏ü‡∏≤‡∏£‡πå‡∏ô‡∏µ‡∏ã‡∏µ‡∏ô (Farnesene) - ‡πÅ‡∏≠‡∏õ‡πÄ‡∏õ‡∏¥‡πâ‡∏•‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‚Üí ‡∏ï‡πâ‡∏≤‡∏ô‡πÅ‡∏ö‡∏Ñ‡∏ó‡∏µ‡πÄ‡∏£‡∏µ‡∏¢, ‡∏õ‡∏•‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÇ‡∏•‡∏°</option>
                                    <option value="‡∏¢‡∏π‡∏Ñ‡∏≤‡∏•‡∏¥‡∏õ‡∏ï‡∏≠‡∏• (Eucalyptol)">‡∏¢‡∏π‡∏Ñ‡∏≤‡∏•‡∏¥‡∏õ‡∏ï‡∏≠‡∏• (Eucalyptol) - ‡πÄ‡∏°‡∏ô‡∏ó‡∏≠‡∏•/‡∏¢‡∏π‡∏Ñ‡∏≤‡∏•‡∏¥‡∏õ‡∏ï‡∏±‡∏™ ‚Üí ‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô, ‡∏ï‡πâ‡∏≤‡∏ô‡∏à‡∏∏‡∏•‡∏ä‡∏µ‡∏û</option>
                                </select>
                                <label for="terpene_1_percentage">% Terpene ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 1</label>
                                <input type="number" id="terpene_1_percentage" name="terpene_1_percentage" 
                                       step="0.01" min="0" max="100" placeholder="0.00">
                            </div>

                            <div class="terpene-column">
                                <label for="terpene_2_select">Terpene ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 2</label>
                                <select id="terpene_2_select" class="terpene-select">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Terpene ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 2</option>
                                    <option value="‡πÑ‡∏°‡∏£‡πå‡∏ã‡∏µ‡∏ô (Myrcene)">‡πÑ‡∏°‡∏£‡πå‡∏ã‡∏µ‡∏ô (Myrcene) - ‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á/‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£ ‚Üí ‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢, ‡∏á‡πà‡∏ß‡∏á</option>
                                    <option value="‡∏•‡∏¥‡πÇ‡∏°‡∏ô‡∏µ‡∏ô (Limonene)">‡∏•‡∏¥‡πÇ‡∏°‡∏ô‡∏µ‡∏ô (Limonene) - ‡∏™‡πâ‡∏°/‡πÄ‡∏•‡∏°‡∏≠‡∏ô ‚Üí ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏î‡∏µ, ‡∏ï‡πâ‡∏≤‡∏ô‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î</option>
                                    <option value="‡πÄ‡∏ö‡∏ï‡∏≤‚Äë‡∏Ñ‡∏≤‡∏£‡∏¥‡πÇ‡∏≠‡∏ü‡∏µ‡∏•‡∏•‡∏µ‡∏ô (Œ≤‚ÄëCaryophyllene)">‡πÄ‡∏ö‡∏ï‡∏≤‚Äë‡∏Ñ‡∏≤‡∏£‡∏¥‡πÇ‡∏≠‡∏ü‡∏µ‡∏•‡∏•‡∏µ‡∏ô (Œ≤‚ÄëCaryophyllene) - ‡∏û‡∏£‡∏¥‡∏Å‡πÑ‡∏ó‡∏¢/‡πÄ‡∏ú‡πá‡∏î ‚Üí ‡∏ö‡∏£‡∏£‡πÄ‡∏ó‡∏≤‡∏õ‡∏ß‡∏î, ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö</option>
                                    <option value="‡∏•‡∏¥‡∏ô‡∏≤‡∏•‡∏π‡∏• (Linalool)">‡∏•‡∏¥‡∏ô‡∏≤‡∏•‡∏π‡∏• (Linalool) - ‡∏•‡∏≤‡πÄ‡∏ß‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå ‚Üí ‡∏Ñ‡∏•‡∏≤‡∏¢‡∏Å‡∏±‡∏á‡∏ß‡∏•, ‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏•‡∏±‡∏ö</option>
                                    <option value="‡πÅ‡∏≠‡∏•‡∏ü‡∏≤‚Äë‡πÑ‡∏û‡∏ô‡∏µ‡∏ô (Œ±‚ÄëPinene)">‡πÅ‡∏≠‡∏•‡∏ü‡∏≤‚Äë‡πÑ‡∏û‡∏ô‡∏µ‡∏ô (Œ±‚ÄëPinene) - ‡∏™‡∏ô ‚Üí ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏≠‡∏î, ‡∏ä‡πà‡∏ß‡∏¢‡πÇ‡∏ü‡∏Å‡∏±‡∏™</option>
                                    <option value="‡∏Æ‡∏¥‡∏ß‡∏°‡∏π‡πÄ‡∏•‡∏ô (Humulene)">‡∏Æ‡∏¥‡∏ß‡∏°‡∏π‡πÄ‡∏•‡∏ô (Humulene) - ‡∏Æ‡πá‡∏≠‡∏õ‡∏™‡πå/‡πÑ‡∏°‡πâ ‚Üí ‡∏•‡∏î‡∏≠‡∏¢‡∏≤‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£, ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö</option>
                                    <option value="‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡∏ô‡∏≠‡∏•‡∏µ‡∏ô (Terpinolene)">‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡∏ô‡∏≠‡∏•‡∏µ‡∏ô (Terpinolene) - ‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ/‡∏™‡∏ô‡∏´‡∏ß‡∏≤‡∏ô ‚Üí ‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡πÄ‡∏ö‡∏≤, ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏π‡∏•‡∏Ø</option>
                                    <option value="‡πÄ‡∏ö‡∏ï‡∏≤‚Äë‡πÑ‡∏û‡∏ô‡∏µ‡∏ô (Œ≤‚ÄëPinene)">‡πÄ‡∏ö‡∏ï‡∏≤‚Äë‡πÑ‡∏û‡∏ô‡∏µ‡∏ô (Œ≤‚ÄëPinene) - ‡πÇ‡∏£‡∏™‡πÅ‡∏°‡∏£‡∏µ‡πà ‚Üí ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö</option>
                                    <option value="‡πÇ‡∏≠‡∏ã‡∏¥‡∏°‡∏µ‡∏ô (Ocimene)">‡πÇ‡∏≠‡∏ã‡∏¥‡∏°‡∏µ‡∏ô (Ocimene) - ‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡∏´‡∏ß‡∏≤‡∏ô ‚Üí ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏´‡∏•‡∏≠‡∏î‡∏•‡∏°, ‡∏ï‡πâ‡∏≤‡∏ô‡πÑ‡∏ß‡∏£‡∏±‡∏™</option>
                                    <option value="‡∏Å‡∏±‡∏°‡∏°‡∏≤‚Äë‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡∏ô‡∏µ‡∏ô (Œ≥‚ÄëTerpinene)">‡∏Å‡∏±‡∏°‡∏°‡∏≤‚Äë‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡∏ô‡∏µ‡∏ô (Œ≥‚ÄëTerpinene) - ‡∏°‡∏∞‡∏ô‡∏≤‡∏ß/‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£ ‚Üí ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏π‡∏•‡∏Ø, ‡∏ï‡πâ‡∏≤‡∏ô‡∏à‡∏∏‡∏•‡∏ä‡∏µ‡∏û</option>
                                    <option value="‡πÄ‡∏ô‡πÇ‡∏£‡∏•‡∏¥‡∏î‡∏≠‡∏• (Nerolidol)">‡πÄ‡∏ô‡πÇ‡∏£‡∏•‡∏¥‡∏î‡∏≠‡∏• (Nerolidol) - ‡∏ä‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß/‡πÑ‡∏°‡πâ ‚Üí ‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠, ‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏•‡∏±‡∏ö</option>
                                    <option value="‡∏ö‡∏¥‡∏ã‡∏≤‡πÇ‡∏ö‡∏•‡∏≠‡∏• (Bisabolol)">‡∏ö‡∏¥‡∏ã‡∏≤‡πÇ‡∏ö‡∏•‡∏≠‡∏• (Bisabolol) - ‡∏Ñ‡∏≤‡πÇ‡∏°‡∏°‡∏≤‡∏¢‡∏•‡πå ‚Üí ‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á‡∏ú‡∏¥‡∏ß, ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö</option>
                                    <option value="‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡πÇ‡∏ô‡∏• (Terpineol)">‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡πÇ‡∏ô‡∏• (Terpineol) - ‡πÑ‡∏°‡πâ‡∏Ç‡∏≤‡∏ß/‡πÑ‡∏û‡∏ô‡πå‡∏´‡∏ß‡∏≤‡∏ô ‚Üí ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏á‡∏ö‡πÉ‡∏à, ‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢</option>
                                    <option value="‡∏ü‡∏≤‡∏£‡πå‡∏ô‡∏µ‡∏ã‡∏µ‡∏ô (Farnesene)">‡∏ü‡∏≤‡∏£‡πå‡∏ô‡∏µ‡∏ã‡∏µ‡∏ô (Farnesene) - ‡πÅ‡∏≠‡∏õ‡πÄ‡∏õ‡∏¥‡πâ‡∏•‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‚Üí ‡∏ï‡πâ‡∏≤‡∏ô‡πÅ‡∏ö‡∏Ñ‡∏ó‡∏µ‡πÄ‡∏£‡∏µ‡∏¢, ‡∏õ‡∏•‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÇ‡∏•‡∏°</option>
                                    <option value="‡∏¢‡∏π‡∏Ñ‡∏≤‡∏•‡∏¥‡∏õ‡∏ï‡∏≠‡∏• (Eucalyptol)">‡∏¢‡∏π‡∏Ñ‡∏≤‡∏•‡∏¥‡∏õ‡∏ï‡∏≠‡∏• (Eucalyptol) - ‡πÄ‡∏°‡∏ô‡∏ó‡∏≠‡∏•/‡∏¢‡∏π‡∏Ñ‡∏≤‡∏•‡∏¥‡∏õ‡∏ï‡∏±‡∏™ ‚Üí ‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô, ‡∏ï‡πâ‡∏≤‡∏ô‡∏à‡∏∏‡∏•‡∏ä‡∏µ‡∏û</option>
                                </select>
                                <label for="terpene_2_percentage">% Terpene ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 2</label>
                                <input type="number" id="terpene_2_percentage" name="terpene_2_percentage" 
                                       step="0.01" min="0" max="100" placeholder="0.00">
                            </div>

                            <div class="terpene-column">
                                <label for="terpene_3_select">Terpene ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 3</label>
                                <select id="terpene_3_select" class="terpene-select">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å Terpene ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 3</option>
                                    <option value="‡πÑ‡∏°‡∏£‡πå‡∏ã‡∏µ‡∏ô (Myrcene)">‡πÑ‡∏°‡∏£‡πå‡∏ã‡∏µ‡∏ô (Myrcene) - ‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á/‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£ ‚Üí ‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢, ‡∏á‡πà‡∏ß‡∏á</option>
                                    <option value="‡∏•‡∏¥‡πÇ‡∏°‡∏ô‡∏µ‡∏ô (Limonene)">‡∏•‡∏¥‡πÇ‡∏°‡∏ô‡∏µ‡∏ô (Limonene) - ‡∏™‡πâ‡∏°/‡πÄ‡∏•‡∏°‡∏≠‡∏ô ‚Üí ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏î‡∏µ, ‡∏ï‡πâ‡∏≤‡∏ô‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î</option>
                                    <option value="‡πÄ‡∏ö‡∏ï‡∏≤‚Äë‡∏Ñ‡∏≤‡∏£‡∏¥‡πÇ‡∏≠‡∏ü‡∏µ‡∏•‡∏•‡∏µ‡∏ô (Œ≤‚ÄëCaryophyllene)">‡πÄ‡∏ö‡∏ï‡∏≤‚Äë‡∏Ñ‡∏≤‡∏£‡∏¥‡πÇ‡∏≠‡∏ü‡∏µ‡∏•‡∏•‡∏µ‡∏ô (Œ≤‚ÄëCaryophyllene) - ‡∏û‡∏£‡∏¥‡∏Å‡πÑ‡∏ó‡∏¢/‡πÄ‡∏ú‡πá‡∏î ‚Üí ‡∏ö‡∏£‡∏£‡πÄ‡∏ó‡∏≤‡∏õ‡∏ß‡∏î, ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö</option>
                                    <option value="‡∏•‡∏¥‡∏ô‡∏≤‡∏•‡∏π‡∏• (Linalool)">‡∏•‡∏¥‡∏ô‡∏≤‡∏•‡∏π‡∏• (Linalool) - ‡∏•‡∏≤‡πÄ‡∏ß‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå ‚Üí ‡∏Ñ‡∏•‡∏≤‡∏¢‡∏Å‡∏±‡∏á‡∏ß‡∏•, ‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏•‡∏±‡∏ö</option>
                                    <option value="‡πÅ‡∏≠‡∏•‡∏ü‡∏≤‚Äë‡πÑ‡∏û‡∏ô‡∏µ‡∏ô (Œ±‚ÄëPinene)">‡πÅ‡∏≠‡∏•‡∏ü‡∏≤‚Äë‡πÑ‡∏û‡∏ô‡∏µ‡∏ô (Œ±‚ÄëPinene) - ‡∏™‡∏ô ‚Üí ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏≠‡∏î, ‡∏ä‡πà‡∏ß‡∏¢‡πÇ‡∏ü‡∏Å‡∏±‡∏™</option>
                                    <option value="‡∏Æ‡∏¥‡∏ß‡∏°‡∏π‡πÄ‡∏•‡∏ô (Humulene)">‡∏Æ‡∏¥‡∏ß‡∏°‡∏π‡πÄ‡∏•‡∏ô (Humulene) - ‡∏Æ‡πá‡∏≠‡∏õ‡∏™‡πå/‡πÑ‡∏°‡πâ ‚Üí ‡∏•‡∏î‡∏≠‡∏¢‡∏≤‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£, ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö</option>
                                    <option value="‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡∏ô‡∏≠‡∏•‡∏µ‡∏ô (Terpinolene)">‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡∏ô‡∏≠‡∏•‡∏µ‡∏ô (Terpinolene) - ‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ/‡∏™‡∏ô‡∏´‡∏ß‡∏≤‡∏ô ‚Üí ‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡πÄ‡∏ö‡∏≤, ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏π‡∏•‡∏Ø</option>
                                    <option value="‡πÄ‡∏ö‡∏ï‡∏≤‚Äë‡πÑ‡∏û‡∏ô‡∏µ‡∏ô (Œ≤‚ÄëPinene)">‡πÄ‡∏ö‡∏ï‡∏≤‚Äë‡πÑ‡∏û‡∏ô‡∏µ‡∏ô (Œ≤‚ÄëPinene) - ‡πÇ‡∏£‡∏™‡πÅ‡∏°‡∏£‡∏µ‡πà ‚Üí ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö</option>
                                    <option value="‡πÇ‡∏≠‡∏ã‡∏¥‡∏°‡∏µ‡∏ô (Ocimene)">‡πÇ‡∏≠‡∏ã‡∏¥‡∏°‡∏µ‡∏ô (Ocimene) - ‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡∏´‡∏ß‡∏≤‡∏ô ‚Üí ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏´‡∏•‡∏≠‡∏î‡∏•‡∏°, ‡∏ï‡πâ‡∏≤‡∏ô‡πÑ‡∏ß‡∏£‡∏±‡∏™</option>
                                    <option value="‡∏Å‡∏±‡∏°‡∏°‡∏≤‚Äë‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡∏ô‡∏µ‡∏ô (Œ≥‚ÄëTerpinene)">‡∏Å‡∏±‡∏°‡∏°‡∏≤‚Äë‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡∏ô‡∏µ‡∏ô (Œ≥‚ÄëTerpinene) - ‡∏°‡∏∞‡∏ô‡∏≤‡∏ß/‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£ ‚Üí ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏π‡∏•‡∏Ø, ‡∏ï‡πâ‡∏≤‡∏ô‡∏à‡∏∏‡∏•‡∏ä‡∏µ‡∏û</option>
                                    <option value="‡πÄ‡∏ô‡πÇ‡∏£‡∏•‡∏¥‡∏î‡∏≠‡∏• (Nerolidol)">‡πÄ‡∏ô‡πÇ‡∏£‡∏•‡∏¥‡∏î‡∏≠‡∏• (Nerolidol) - ‡∏ä‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß/‡πÑ‡∏°‡πâ ‚Üí ‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠, ‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏•‡∏±‡∏ö</option>
                                    <option value="‡∏ö‡∏¥‡∏ã‡∏≤‡πÇ‡∏ö‡∏•‡∏≠‡∏• (Bisabolol)">‡∏ö‡∏¥‡∏ã‡∏≤‡πÇ‡∏ö‡∏•‡∏≠‡∏• (Bisabolol) - ‡∏Ñ‡∏≤‡πÇ‡∏°‡∏°‡∏≤‡∏¢‡∏•‡πå ‚Üí ‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á‡∏ú‡∏¥‡∏ß, ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö</option>
                                    <option value="‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡πÇ‡∏ô‡∏• (Terpineol)">‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡πÇ‡∏ô‡∏• (Terpineol) - ‡πÑ‡∏°‡πâ‡∏Ç‡∏≤‡∏ß/‡πÑ‡∏û‡∏ô‡πå‡∏´‡∏ß‡∏≤‡∏ô ‚Üí ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏á‡∏ö‡πÉ‡∏à, ‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢</option>
                                    <option value="‡∏ü‡∏≤‡∏£‡πå‡∏ô‡∏µ‡∏ã‡∏µ‡∏ô (Farnesene)">‡∏ü‡∏≤‡∏£‡πå‡∏ô‡∏µ‡∏ã‡∏µ‡∏ô (Farnesene) - ‡πÅ‡∏≠‡∏õ‡πÄ‡∏õ‡∏¥‡πâ‡∏•‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‚Üí ‡∏ï‡πâ‡∏≤‡∏ô‡πÅ‡∏ö‡∏Ñ‡∏ó‡∏µ‡πÄ‡∏£‡∏µ‡∏¢, ‡∏õ‡∏•‡∏≠‡∏ö‡∏õ‡∏£‡∏∞‡πÇ‡∏•‡∏°</option>
                                    <option value="‡∏¢‡∏π‡∏Ñ‡∏≤‡∏•‡∏¥‡∏õ‡∏ï‡∏≠‡∏• (Eucalyptol)">‡∏¢‡∏π‡∏Ñ‡∏≤‡∏•‡∏¥‡∏õ‡∏ï‡∏≠‡∏• (Eucalyptol) - ‡πÄ‡∏°‡∏ô‡∏ó‡∏≠‡∏•/‡∏¢‡∏π‡∏Ñ‡∏≤‡∏•‡∏¥‡∏õ‡∏ï‡∏±‡∏™ ‚Üí ‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô, ‡∏ï‡πâ‡∏≤‡∏ô‡∏à‡∏∏‡∏•‡∏ä‡∏µ‡∏û</option>
                                </select>
                                <label for="terpene_3_percentage">% Terpene ‡∏≠‡∏±‡∏ô‡∏î‡∏±‡∏ö 3</label>
                                <input type="number" id="terpene_3_percentage" name="terpene_3_percentage" 
                                       step="0.01" min="0" max="100" placeholder="0.00">
                            </div>
                        </div>

                        <!-- Hidden inputs for form submission -->
                        <input type="hidden" id="top_terpenes_1" name="top_terpenes_1">
                        <input type="hidden" id="top_terpenes_2" name="top_terpenes_2">
                        <input type="hidden" id="top_terpenes_3" name="top_terpenes_3">
                    </div>

                    <!-- Effects & Usage -->
                    <div class="form-section">
                        <div class="section-title">
                            ‚ú® ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÅ‡∏•‡∏∞‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô
                        </div>

                        <div class="effects-two-columns">
                            <!-- Mental Effects Column -->
                            <div class="effects-column">
                                <h3 class="column-title">üß† ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ï‡πà‡∏≠‡∏à‡∏¥‡∏ï‡πÉ‡∏à</h3>

                                <!-- Mental Positive Effects -->
                                <div class="form-group effects-selector">
                                    <label>üòä ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏ö‡∏ß‡∏Å</label>
                                    <div id="selected-mental-positive" class="selected-effects">
                                        <span class="placeholder">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏ö‡∏ß‡∏Å...</span>
                                    </div>
                                    <textarea id="mental_effects_positive" name="mental_effects_positive" style="display: none;"></textarea>
                                    <div class="effects-categories">
                                        <div class="effect-options">
                                            <button type="button" class="effect-btn" data-effect="‡∏™‡∏∏‡∏Ç‡πÉ‡∏à">üòÑ ‡∏™‡∏∏‡∏Ç‡πÉ‡∏à</button>
                                            <button type="button" class="effect-btn" data-effect="‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢">üòå ‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢</button>
                                            <button type="button" class="effect-btn" data-effect="‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå">üé® ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå</button>
                                            <button type="button" class="effect-btn" data-effect="‡∏£‡πà‡∏≤‡πÄ‡∏£‡∏¥‡∏á">üòÜ ‡∏£‡πà‡∏≤‡πÄ‡∏£‡∏¥‡∏á</button>
                                            <button type="button" class="effect-btn" data-effect="‡πÄ‡∏ö‡∏¥‡∏Å‡∏ö‡∏≤‡∏ô">ü§ó ‡πÄ‡∏ö‡∏¥‡∏Å‡∏ö‡∏≤‡∏ô</button>
                                            <button type="button" class="effect-btn" data-effect="‡πÇ‡∏ü‡∏Å‡∏±‡∏™">üéØ ‡πÇ‡∏ü‡∏Å‡∏±‡∏™</button>
                                            <button type="button" class="effect-btn" data-effect="‡∏ï‡∏∑‡πà‡∏ô‡∏ï‡∏±‡∏ß">‚ö° ‡∏ï‡∏∑‡πà‡∏ô‡∏ï‡∏±‡∏ß</button>
                                            <button type="button" class="effect-btn" data-effect="‡∏Ñ‡∏¥‡∏î‡∏•‡∏∂‡∏Å">üß† ‡∏Ñ‡∏¥‡∏î‡∏•‡∏∂‡∏Å</button>
                                            <button type="button" class="effect-btn" data-effect="‡∏´‡∏•‡∏±‡∏ö‡∏á‡πà‡∏≤‡∏¢">üò¥ ‡∏´‡∏•‡∏±‡∏ö‡∏á‡πà‡∏≤‡∏¢</button>
                                            <button type="button" class="effect-btn" data-effect="‡πÄ‡∏û‡∏•‡∏¥‡∏î‡πÄ‡∏û‡∏•‡∏¥‡∏ô">üéâ ‡πÄ‡∏û‡∏•‡∏¥‡∏î‡πÄ‡∏û‡∏•‡∏¥‡∏ô</button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Mental Negative Effects -->
                                <div class="form-group effects-selector">
                                    <label>üòü ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏ö</label>
                                    <div id="selected-mental-negative" class="selected-effects">
                                        <span class="placeholder">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏ö...</span>
                                    </div>
                                    <textarea id="mental_effects_negative" name="mental_effects_negative" style="display: none;"></textarea>
                                    <div class="effects-categories">
                                        <div class="effect-options">
                                            <button type="button" class="effect-btn negative" data-effect="‡∏ß‡∏¥‡∏ï‡∏Å">üò∞ ‡∏ß‡∏¥‡∏ï‡∏Å</button>
                                            <button type="button" class="effect-btn negative" data-effect="‡∏û‡∏≤‡∏£‡∏≤‡∏ô‡∏≠‡∏¢‡∏î‡πå">üëÅÔ∏è ‡∏û‡∏≤‡∏£‡∏≤‡∏ô‡∏≠‡∏¢‡∏î‡πå</button>
                                            <button type="button" class="effect-btn negative" data-effect="‡πÅ‡∏û‡∏ô‡∏¥‡∏Ñ">üò± ‡πÅ‡∏û‡∏ô‡∏¥‡∏Ñ</button>
                                            <button type="button" class="effect-btn negative" data-effect="‡∏™‡∏±‡∏ö‡∏™‡∏ô">üòµ ‡∏™‡∏±‡∏ö‡∏™‡∏ô</button>
                                            <button type="button" class="effect-btn negative" data-effect="‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡∏™‡∏±‡πâ‡∏ô">ü§î ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏≥‡∏™‡∏±‡πâ‡∏ô</button>
                                            <button type="button" class="effect-btn negative" data-effect="‡∏™‡∏°‡∏≤‡∏ò‡∏¥‡∏´‡∏≤‡∏¢">üå™Ô∏è ‡∏™‡∏°‡∏≤‡∏ò‡∏¥‡∏´‡∏≤‡∏¢</button>
                                            <button type="button" class="effect-btn negative" data-effect="‡∏´‡∏•‡∏≠‡∏ô">üëª ‡∏´‡∏•‡∏≠‡∏ô</button>
                                            <button type="button" class="effect-btn negative" data-effect="‡∏á‡πà‡∏ß‡∏á‡∏´‡∏ô‡∏±‡∏Å">üò™ ‡∏á‡πà‡∏ß‡∏á‡∏´‡∏ô‡∏±‡∏Å</button>
                                            <button type="button" class="effect-btn negative" data-effect="‡∏ã‡∏∂‡∏°‡πÄ‡∏®‡∏£‡πâ‡∏≤">üòî ‡∏ã‡∏∂‡∏°‡πÄ‡∏®‡∏£‡πâ‡∏≤</button>
                                            <button type="button" class="effect-btn negative" data-effect="‡∏´‡∏á‡∏∏‡∏î‡∏´‡∏á‡∏¥‡∏î">üò§ ‡∏´‡∏á‡∏∏‡∏î‡∏´‡∏á‡∏¥‡∏î</button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Physical Effects Column -->
                            <div class="effects-column">
                                <h3 class="column-title">üí™ ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏ó‡∏≤‡∏á‡∏£‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏¢</h3>

                                <!-- Physical Positive Effects -->
                                <div class="form-group effects-selector">
                                    <label>üí™ ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏ö‡∏ß‡∏Å</label>
                                    <div id="selected-physical-positive" class="selected-effects">
                                        <span class="placeholder">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏ö‡∏ß‡∏Å...</span>
                                    </div>
                                    <textarea id="physical_effects_positive" name="physical_effects_positive" style="display: none;"></textarea>
                                    <div class="effects-categories">
                                        <div class="effect-options">
                                            <button type="button" class="effect-btn" data-effect="‡∏ö‡∏£‡∏£‡πÄ‡∏ó‡∏≤‡∏õ‡∏ß‡∏î">ü©π ‡∏ö‡∏£‡∏£‡πÄ‡∏ó‡∏≤‡∏õ‡∏ß‡∏î</button>
                                            <button type="button" class="effect-btn" data-effect="‡∏Ñ‡∏•‡∏≤‡∏¢‡∏Å‡∏•‡πâ‡∏≤‡∏°">üíÜ ‡∏Ñ‡∏•‡∏≤‡∏¢‡∏Å‡∏•‡πâ‡∏≤‡∏°</button>
                                            <button type="button" class="effect-btn" data-effect="‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö">üõ°Ô∏è ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö</button>
                                            <button type="button" class="effect-btn" data-effect="‡∏´‡∏•‡∏±‡∏ö‡∏á‡πà‡∏≤‡∏¢">üò¥ ‡∏´‡∏•‡∏±‡∏ö‡∏á‡πà‡∏≤‡∏¢</button>
                                            <button type="button" class="effect-btn" data-effect="‡∏Ñ‡∏•‡∏≤‡∏¢‡πÄ‡∏Å‡∏£‡πá‡∏á">üßò ‡∏Ñ‡∏•‡∏≤‡∏¢‡πÄ‡∏Å‡∏£‡πá‡∏á</button>
                                            <button type="button" class="effect-btn" data-effect="‡∏ï‡πâ‡∏≤‡∏ô‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÑ‡∏™‡πâ">ü§¢ ‡∏ï‡πâ‡∏≤‡∏ô‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÑ‡∏™‡πâ</button>
                                            <button type="button" class="effect-btn" data-effect="‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡∏Å‡∏¥‡∏ô">üçΩÔ∏è ‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡∏Å‡∏¥‡∏ô</button>
                                            <button type="button" class="effect-btn" data-effect="‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢">üòå ‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢</button>
                                            <button type="button" class="effect-btn" data-effect="‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô">‚ú® ‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô</button>
                                            <button type="button" class="effect-btn" data-effect="‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏•‡∏≥‡πÑ‡∏™‡πâ">ü´Å ‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏•‡∏≥‡πÑ‡∏™‡πâ</button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Physical Negative Effects -->
                                <div class="form-group effects-selector">
                                    <label>ü§í ‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏ö</label>
                                    <div id="selected-physical-negative" class="selected-effects">
                                        <span class="placeholder">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏ö...</span>
                                    </div>
                                    <textarea id="physical_effects_negative" name="physical_effects_negative" style="display: none;"></textarea>
                                    <div class="effects-categories">
                                        <div class="effect-options">
                                            <button type="button" class="effect-btn negative" data-effect="‡∏õ‡∏≤‡∏Å‡πÅ‡∏´‡πâ‡∏á">üëÑ ‡∏õ‡∏≤‡∏Å‡πÅ‡∏´‡πâ‡∏á</button>
                                            <button type="button" class="effect-btn negative" data-effect="‡∏ï‡∏≤‡πÅ‡∏î‡∏á">üëÅÔ∏è ‡∏ï‡∏≤‡πÅ‡∏î‡∏á</button>
                                            <button type="button" class="effect-btn negative" data-effect="‡∏ï‡∏≤‡πÅ‡∏´‡πâ‡∏á">üèúÔ∏è ‡∏ï‡∏≤‡πÅ‡∏´‡πâ‡∏á</button>
                                            <button type="button" class="effect-btn negative" data-effect="‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡∏´‡∏±‡∏ß">üí´ ‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡∏´‡∏±‡∏ß</button>
                                            <button type="button" class="effect-btn negative" data-effect="‡πÉ‡∏à‡πÄ‡∏ï‡πâ‡∏ô‡πÄ‡∏£‡πá‡∏ß">üíì ‡πÉ‡∏à‡πÄ‡∏ï‡πâ‡∏ô‡πÄ‡∏£‡πá‡∏ß</button>
                                            <button type="button" class="effect-btn negative" data-effect="‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏ï‡∏Å">üìâ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏î‡∏±‡∏ô‡∏ï‡∏Å</button>
                                            <button type="button" class="effect-btn negative" data-effect="‡∏°‡∏∑‡∏≠‡∏™‡∏±‡πà‡∏ô">ü§≤ ‡∏°‡∏∑‡∏≠‡∏™‡∏±‡πà‡∏ô</button>
                                            <button type="button" class="effect-btn negative" data-effect="‡πÄ‡∏´‡∏á‡∏∑‡πà‡∏≠‡∏≠‡∏≠‡∏Å">üí¶ ‡πÄ‡∏´‡∏á‡∏∑‡πà‡∏≠‡∏≠‡∏≠‡∏Å</button>
                                            <button type="button" class="effect-btn negative" data-effect="‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÑ‡∏™‡πâ">ü§Æ ‡∏Ñ‡∏•‡∏∑‡πà‡∏ô‡πÑ‡∏™‡πâ</button>
                                            <button type="button" class="effect-btn negative" data-effect="‡πÑ‡∏≠/‡πÄ‡∏à‡πá‡∏ö‡∏Ñ‡∏≠">üò∑ ‡πÑ‡∏≠/‡πÄ‡∏à‡πá‡∏ö‡∏Ñ‡∏≠</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="recommended_time">‚è∞ ‡πÄ‡∏ß‡∏•‡∏≤‡∏ó‡∏µ‡πà‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥</label>
                                <select id="recommended_time" name="recommended_time">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏ß‡∏•‡∏≤</option>
                                    <option value="‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô">‚òÄÔ∏è ‡∏Å‡∏•‡∏≤‡∏á‡∏ß‡∏±‡∏ô</option>
                                    <option value="‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô">üåô ‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô</option>
                                    <option value="‡∏ï‡∏•‡∏≠‡∏î‡∏ß‡∏±‡∏ô">üåÖ ‡∏ï‡∏•‡∏≠‡∏î‡∏ß‡∏±‡∏ô</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Growing Information -->
                    <div class="form-section">
                        <div class="section-title">
                            üå± ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏π‡∏Å
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="grow_method">‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏π‡∏Å</label>
                                <select id="grow_method" name="grow_method">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏õ‡∏•‡∏π‡∏Å</option>
                                    <option value="Indoor">Indoor</option>
                                    <option value="Outdoor">Outdoor</option>
                                    <option value="Greenhouse">Greenhouse</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="fertilizer_type">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏õ‡∏∏‡πà‡∏¢</label>
                                <select id="fertilizer_type" name="fertilizer_type">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏õ‡∏∏‡πà‡∏¢</option>
                                    <option value="Organic">Organic</option>
                                    <option value="Chemical">Chemical</option>
                                    <option value="Mixed">Mixed</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="flowering_type">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏î‡∏≠‡∏Å</label>
                                <select id="flowering_type" name="flowering_type">
                                    <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</option>
                                    <option value="Photoperiod">Photoperiod</option>
                                    <option value="Autoflower">Autoflower</option>
                                </select>
                            </div>
                        </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="harvest_date">‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏Å‡∏µ‡πà‡∏¢‡∏ß</label>
                                <input type="date" id="harvest_date" name="harvest_date">
                            </div>
                            <div class="form-group">
                                <label for="batch_number">‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç Batch</label>
                                <input type="text" id="batch_number" name="batch_number">
                            </div>
                        </div>
                    </div>

                    <!-- Image Management Section -->
                    <div class="form-section">
                        <div class="section-title">
                            üì∏ ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û
                        </div>
                        <div class="image-upload-section">
                            <p class="help-text">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏î‡∏≠‡∏Å (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 4 ‡∏£‡∏π‡∏õ, ‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 16MB ‡∏ï‡πà‡∏≠‡∏£‡∏π‡∏õ) - ‡∏Å‡∏î‡∏•‡∏ö‡∏£‡∏π‡∏õ‡πÄ‡∏î‡∏¥‡∏°‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏π‡∏õ‡πÉ‡∏´‡∏°‡πà‡πÑ‡∏î‡πâ</p>

                            <div class="image-upload-grid">
                                <div class="image-upload-item">
                                    <label for="image_1" class="upload-label">
                                        <div class="upload-placeholder">
                                            <span class="upload-icon">üì∑</span>
                                            <span class="upload-text">‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 1</span>
                                        </div>
                                    </label>
                                    <input type="file" id="image_1" name="image_1" accept="image/*" style="display: none;">
                                    <div class="image-preview" id="preview_1" style="display: none;">
                                        <img src="" alt="Preview">
                                        <button type="button" class="remove-image-btn" onclick="removeImage(1)">√ó</button>
                                    </div>
                                    <div class="current-image" id="current_1" style="display: none;">
                                        <img src="" alt="Current Image">
                                        <button type="button" class="remove-image-btn" onclick="removeCurrentImage(1)">√ó</button>
                                        <button type="button" class="replace-image-btn" onclick="replaceCurrentImage(1)">üîÑ</button>
                                    </div>
                                </div>

                                <div class="image-upload-item">
                                    <label for="image_2" class="upload-label">
                                        <div class="upload-placeholder">
                                            <span class="upload-icon">üì∑</span>
                                            <span class="upload-text">‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 2</span>
                                        </div>
                                    </label>
                                    <input type="file" id="image_2" name="image_2" accept="image/*" style="display: none;">
                                    <div class="image-preview" id="preview_2" style="display: none;">
                                        <img src="" alt="Preview">
                                        <button type="button" class="remove-image-btn" onclick="removeImage(2)">√ó</button>
                                    </div>
                                    <div class="current-image" id="current_2" style="display: none;">
                                        <img src="" alt="Current Image">
                                        <button type="button" class="remove-image-btn" onclick="removeCurrentImage(2)">√ó</button>
                                        <button type="button" class="replace-image-btn" onclick="replaceCurrentImage(2)">üîÑ</button>
                                    </div>
                                </div>

                                <div class="image-upload-item">
                                    <label for="image_3" class="upload-label">
                                        <div class="upload-placeholder">
                                            <span class="upload-icon">üì∑</span>
                                            <span class="upload-text">‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 3</span>
                                        </div>
                                    </label>
                                    <input type="file" id="image_3" name="image_3" accept="image/*" style="display: none;">
                                    <div class="image-preview" id="preview_3" style="display: none;">
                                        <img src="" alt="Preview">
                                        <button type="button" class="remove-image-btn" onclick="removeImage(3)">√ó</button>
                                    </div>
                                    <div class="current-image" id="current_3" style="display: none;">
                                        <img src="" alt="Current Image">
                                        <button type="button" class="remove-image-btn" onclick="removeCurrentImage(3)">√ó</button>
                                        <button type="button" class="replace-image-btn" onclick="replaceCurrentImage(3)">üîÑ</button>
                                    </div>
                                </div>

                                <div class="image-upload-item">
                                    <label for="image_4" class="upload-label">
                                        <div class="upload-placeholder">
                                            <span class="upload-icon">üì∑</span>
                                            <span class="upload-text">‡∏£‡∏π‡∏õ‡∏ó‡∏µ‡πà 4</span>
                                        </div>
                                    </label>
                                    <input type="file" id="image_4" name="image_4" accept="image/*" style="display: none;">
                                    <div class="image-preview" id="preview_4" style="display: none;">
                                        <img src="" alt="Preview">
                                        <button type="button" class="remove-image-btn" onclick="removeImage(4)">√ó</button>
                                    </div>
                                    <div class="current-image" id="current_4" style="display: none;">
                                        <img src="" alt="Current Image">
                                        <button type="button" class="remove-image-btn" onclick="removeCurrentImage(4)">√ó</button>
                                        <button type="button" class="replace-image-btn" onclick="replaceCurrentImage(4)">üîÑ</button>
                                    </div>
                                </div>
                            </div>

                            <div class="upload-actions">
                                <button type="button" id="clearAllImagesBtn" class="btn btn-secondary" onclick="clearAllImages()">
                                    üóëÔ∏è ‡∏•‡πâ‡∏≤‡∏á‡∏£‡∏π‡∏õ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                                </button>
                            </div>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" id="submitBtn" class="btn btn-primary">
                            üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç
                        </button>
                        <a href="/activity" class="btn btn-secondary">
                            ‚ùå ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                        </a>
                    </div>
            </form>
        </div>
    </div>

    <script>
        let currentBudId = null;
        let isLoading = false;
        let selectedFlavors = [];
        let selectedEffects = {
            mentalPositive: [],
            mentalNegative: [],
            physicalPositive: [],
            physicalNegative: []
        };

        // Terpene data (example, should be fetched or defined)
        const terpeneData = [
            { name: "‡πÑ‡∏°‡∏£‡πå‡∏ã‡∏µ‡∏ô (Myrcene)", effects: "‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á/‡∏™‡∏°‡∏∏‡∏ô‡πÑ‡∏û‡∏£ ‚Üí ‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢, ‡∏á‡πà‡∏ß‡∏á", category: "Terpenes" },
            { name: "‡∏•‡∏¥‡πÇ‡∏°‡∏ô‡∏µ‡∏ô (Limonene)", effects: "‡∏™‡πâ‡∏°/‡πÄ‡∏•‡∏°‡∏≠‡∏ô ‚Üí ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏î‡∏µ, ‡∏ï‡πâ‡∏≤‡∏ô‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î", category: "Terpenes" },
            { name: "‡πÅ‡∏≠‡∏•‡∏ü‡∏≤‚Äë‡πÑ‡∏û‡∏ô‡∏µ‡∏ô (Œ±‚ÄëPinene)", effects: "‡∏™‡∏ô ‚Üí ‡πÄ‡∏õ‡∏¥‡∏î‡∏õ‡∏≠‡∏î, ‡∏ä‡πà‡∏ß‡∏¢‡πÇ‡∏ü‡∏Å‡∏±‡∏™", category: "Terpenes" },
            { name: "‡πÄ‡∏ö‡∏ï‡∏≤‚Äë‡πÑ‡∏û‡∏ô‡∏µ‡∏ô (Œ≤‚ÄëPinene)", effects: "‡πÇ‡∏£‡∏™‡πÅ‡∏°‡∏£‡∏µ‡πà ‚Üí ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö", category: "Terpenes" },
            { name: "‡πÄ‡∏ö‡∏ï‡∏≤‚Äë‡∏Ñ‡∏≤‡∏£‡∏¥‡πÇ‡∏≠‡∏ü‡∏µ‡∏•‡∏•‡∏µ‡∏ô (Œ≤‚ÄëCaryophyllene)", effects: "‡∏û‡∏£‡∏¥‡∏Å‡πÑ‡∏ó‡∏¢/‡πÄ‡∏ú‡πá‡∏î ‚Üí ‡∏ö‡∏£‡∏£‡πÄ‡∏ó‡∏≤‡∏õ‡∏ß‡∏î, ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö", category: "Terpenes" },
            { name: "‡∏•‡∏¥‡∏ô‡∏≤‡∏•‡∏π‡∏• (Linalool)", effects: "‡∏•‡∏≤‡πÄ‡∏ß‡∏ô‡πÄ‡∏î‡∏≠‡∏£‡πå ‚Üí ‡∏Ñ‡∏•‡∏≤‡∏¢‡∏Å‡∏±‡∏á‡∏ß‡∏•, ‡∏ä‡πà‡∏ß‡∏¢‡∏´‡∏•‡∏±‡∏ö", category: "Terpenes" },
            { name: "‡∏Æ‡∏¥‡∏ß‡∏°‡∏π‡πÄ‡∏•‡∏ô (Humulene)", effects: "‡∏Æ‡πá‡∏≠‡∏õ‡∏™‡πå/‡πÑ‡∏°‡πâ ‚Üí ‡∏•‡∏î‡∏≠‡∏¢‡∏≤‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£, ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö", category: "Terpenes" },
            { name: "‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡∏ô‡∏≠‡∏•‡∏µ‡∏ô (Terpinolene)", effects: "‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ/‡∏™‡∏ô‡∏´‡∏ß‡∏≤‡∏ô ‚Üí ‡∏Å‡∏£‡∏∞‡∏ï‡∏∏‡πâ‡∏ô‡πÄ‡∏ö‡∏≤, ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏ô‡∏∏‡∏°‡∏π‡∏•‡∏Ø", category: "Terpenes" },
            { name: "‡πÇ‡∏≠‡∏ã‡∏¥‡∏°‡∏µ‡∏ô (Ocimene)", effects: "‡∏î‡∏≠‡∏Å‡πÑ‡∏°‡πâ‡∏´‡∏ß‡∏≤‡∏ô ‚Üí ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏´‡∏•‡∏≠‡∏î‡∏•‡∏°, ‡∏ï‡πâ‡∏≤‡∏ô‡πÑ‡∏ß‡∏£‡∏±‡∏™", category: "Terpenes" },
            { name: "‡∏¢‡∏π‡∏Ñ‡∏≤‡∏•‡∏¥‡∏õ‡∏ï‡∏≠‡∏• / 1,8‚Äë‡∏ã‡∏¥‡πÄ‡∏ô‡∏≠‡∏≠‡∏• (Eucalyptol)", effects: "‡πÄ‡∏°‡∏ô‡∏ó‡∏≠‡∏•/‡∏¢‡∏π‡∏Ñ‡∏≤‡∏•‡∏¥‡∏õ‡∏ï‡∏±‡∏™ ‚Üí ‡∏™‡∏î‡∏ä‡∏∑‡πà‡∏ô,‡∏ï‡πâ‡∏≤‡∏ô‡∏à‡∏∏‡∏•‡∏ä‡∏µ‡∏û", category: "Terpenes" },
            { name: "‡πÄ‡∏ô‡πÇ‡∏£‡∏•‡∏¥‡∏î‡∏≠‡∏• (Nerolidol)", effects: "‡∏ä‡∏≤‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß/‡πÑ‡∏°‡πâ ‚Üí ‡∏ú‡πà‡∏≠‡∏ô‡∏Ñ‡∏•‡∏≤‡∏¢‡∏Å‡∏•‡πâ‡∏≤‡∏°‡πÄ‡∏ô‡∏∑‡πâ‡∏≠", category: "Terpenes" },
            { name: "‡∏ö‡∏¥‡∏ã‡∏≤‡πÇ‡∏ö‡∏•‡∏≠‡∏• (Bisabolol)", effects: "‡∏Ñ‡∏≤‡πÇ‡∏°‡∏°‡∏≤‡∏¢‡∏•‡πå ‚Üí ‡∏õ‡∏Å‡∏õ‡πâ‡∏≠‡∏á‡∏ú‡∏¥‡∏ß, ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏±‡∏Å‡πÄ‡∏™‡∏ö", category: "Terpenes" },
            { name: "‡∏ü‡∏≤‡∏£‡πå‡∏ô‡∏µ‡∏ã‡∏µ‡∏ô (Farnesene)", effects: "‡πÅ‡∏≠‡∏õ‡πÄ‡∏õ‡∏¥‡πâ‡∏•‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß ‚Üí ‡∏ï‡πâ‡∏≤‡∏ô‡πÅ‡∏ö‡∏Ñ‡∏ó‡∏µ‡πÄ‡∏£‡∏µ‡∏¢", category: "Terpenes" },
            { name: "‡πÅ‡∏Ñ‡∏°‡∏ü‡∏µ‡∏ô (Camphene)", effects: "‡∏Å‡∏≤‡∏£‡∏ö‡∏π‡∏£‡πÄ‡∏ö‡∏≤ ‚Üí ‡∏ï‡πâ‡∏≤‡∏ô‡∏≠‡∏≠‡∏Å‡∏ã‡∏¥‡πÅ‡∏î‡∏ô‡∏ï‡πå", category: "Terpenes" },
            { name: "‡πÄ‡∏ó‡∏≠‡∏£‡πå‡∏û‡∏¥‡πÇ‡∏ô‡∏• (Terpineol)", effects: "‡πÑ‡∏°‡πâ‡∏Ç‡∏≤‡∏ß/‡πÑ‡∏û‡∏ô‡πå‡∏´‡∏ß‡∏≤‡∏ô ‚Üí ‡∏ä‡πà‡∏ß‡∏¢‡∏™‡∏á‡∏ö‡πÉ‡∏à", category: "Terpenes" },
            { name: "‡∏ß‡∏≤‡∏•‡∏¥‡∏ô‡∏ã‡∏µ‡∏ô (Valencene)", effects: "‡∏™‡πâ‡∏°‡∏ß‡∏≤‡πÄ‡∏•‡∏ô‡πÄ‡∏ã‡∏µ‡∏¢ ‚Üí ‡∏¢‡∏±‡∏ö‡∏¢‡∏±‡πâ‡∏á‡∏¢‡∏∏‡∏á, ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå‡∏î‡∏µ", category: "Terpenes" },
            { name: "‡πÄ‡∏à‡∏≠‡∏£‡∏≤‡πÄ‡∏ô‡∏µ‡∏¢‡∏• (Geraniol)", effects: "‡∏Å‡∏∏‡∏´‡∏•‡∏≤‡∏ö ‚Üí ‡∏ï‡πâ‡∏≤‡∏ô‡∏à‡∏∏‡∏•‡∏ä‡∏µ‡∏û", category: "Terpenes" }
        ];

        // Get bud ID from URL parameters
        function getBudIdFromUrl() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('id');
        }

        function showError(message, canRetry = true) {
            console.error('Error:', message);

            const loadingState = document.getElementById('loadingState');
            const errorState = document.getElementById('errorState');
            const formContainer = document.getElementById('formContainer');
            const errorMessage = document.getElementById('errorMessage');

            if (loadingState) loadingState.style.display = 'none';
            if (formContainer) formContainer.style.display = 'none';
            if (errorState) {
                errorState.style.display = 'block';
                if (errorMessage) {
                    errorMessage.textContent = message;
                }

                const retryBtn = errorState.querySelector('.retry-btn');
                if (retryBtn) {
                    retryBtn.style.display = canRetry ? 'inline-block' : 'none';
                }
            }
        }

        function showLoading() {
            const loadingState = document.getElementById('loadingState');
            const errorState = document.getElementById('errorState');
            const formContainer = document.getElementById('formContainer');

            if (loadingState) loadingState.style.display = 'block';
            if (errorState) errorState.style.display = 'none';
            if (formContainer) formContainer.style.display = 'none';
        }

        function showForm() {
            const loadingState = document.getElementById('loadingState');
            const errorState = document.getElementById('errorState');
            const formContainer = document.getElementById('formContainer');

            if (loadingState) loadingState.style.display = 'none';
            if (errorState) errorState.style.display = 'none';
            if (formContainer) formContainer.style.display = 'block';
        }

        function showAlert(message, type = 'success') {
            const alertContainer = document.getElementById('alertContainer');
            const alertClass = type === 'success' ? 'alert-success' : 'alert-error';

            alertContainer.innerHTML = `
                <div class="alert ${alertClass}">
                    ${message}
                </div>
            `;

            // Auto-hide after 5 seconds
            setTimeout(() => {
                alertContainer.innerHTML = '';
            }, 5000);
        }

        async function loadBudData() {
            if (isLoading) {
                console.log('Already loading, skipping duplicate request');
                return;
            }

            currentBudId = getBudIdFromUrl();

            if (!currentBudId) {
                showError('‡πÑ‡∏°‡πà‡∏û‡∏ö ID ‡∏Ç‡∏≠‡∏á‡∏î‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏î‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏´‡∏ô‡πâ‡∏≤‡∏Å‡∏¥‡∏à‡∏Å‡∏£‡∏£‡∏°', false);
                return;
            }

            // Check if data is already loaded
            if (currentBudId && document.getElementById('strain_name_en').value) {
                console.log('Data already loaded, skipping...');
                showForm();
                return;
            }

            isLoading = true;
            showLoading();

            try {
                console.log(`Loading bud data for ID: ${currentBudId}`);

                const response = await fetch(`/api/buds/${currentBudId}`, {
                    method: 'GET',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                if (!response.ok) {
                    if (response.status === 404) {
                        throw new Error('‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏≠‡∏Å‡∏´‡∏£‡∏∑‡∏≠‡∏Ñ‡∏∏‡∏ì‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á');
                    } else if (response.status === 401) {
                        throw new Error('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà');
                    } else {
                        throw new Error(`‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (${response.status})`);
                    }
                }

                const budData = await response.json();

                if (budData.error) {
                    throw new Error(budData.error);
                }

                console.log('Bud data loaded successfully:', budData.strain_name_en);
                populateForm(budData);
                loadCurrentImages(budData);
                loadCurrentCertificateImages(budData);
                showForm();
                // Load existing terpene selections
                loadTerpeneData(budData);


            } catch (error) {
                console.error('Error loading bud data:', error);
                showError(error.message || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏≠‡∏Å‡πÑ‡∏î‡πâ ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà‡∏≠‡∏µ‡∏Å‡∏Ñ‡∏£‡∏±‡πâ‡∏á');
            } finally {
                isLoading = false;
            }
        }

        function loadCurrentImages(budData) {
            // Load current images into the unified interface
            for (let i = 1; i <= 4; i++) {
                const imageUrl = budData[`image_${i}_url`];
                if (imageUrl) {
                    showCurrentImage(i, imageUrl);
                }
            }
        }

        function showCurrentImage(index, imageUrl) {
            const label = document.querySelector(`label[for="image_${index}"]`);
            const preview = document.getElementById(`preview_${index}`);
            const current = document.getElementById(`current_${index}`);

            if (label && current) {
                label.style.display = 'none';
                if (preview) preview.style.display = 'none';
                current.style.display = 'block';
                current.querySelector('img').src = imageUrl;
            }
        }

        function removeCurrentImage(index) {
            const label = document.querySelector(`label[for="image_${index}"]`);
            const current = document.getElementById(`current_${index}`);
            const input = document.getElementById(`image_${index}`);

            if (label && current) {
                current.style.display = 'none';
                current.querySelector('img').src = '';
                label.style.display = 'block';

                // Clear any new file selection too
                if (input) input.value = '';

                // Mark for deletion - create hidden input to track deletion
                current.setAttribute('data-deleted', 'true');

                // Add hidden field to form to indicate deletion
                let deletionInput = document.getElementById(`deleted_image_${index}`);
                if (!deletionInput) {
                    deletionInput = document.createElement('input');
                    deletionInput.type = 'hidden';
                    deletionInput.id = `deleted_image_${index}`;
                    deletionInput.name = `deleted_image_${index}`;
                    document.getElementById('editBudForm').appendChild(deletionInput);
                }
                deletionInput.value = 'true';
            }
        }

        function replaceCurrentImage(index) {
            const input = document.getElementById(`image_${index}`);
            if (input) {
                // Clear deletion flag when replacing image
                const current = document.getElementById(`current_${index}`);
                if (current) {
                    current.removeAttribute('data-deleted');
                }

                // Remove deletion input if exists
                const deletionInput = document.getElementById(`deleted_image_${index}`);
                if (deletionInput) {
                    deletionInput.remove();
                }

                input.click();
            }
        }

        function viewImage(url) {
            // Simple image preview
            window.open(url, '_blank');
        }

        function populateForm(budData) {
            // Basic fields
            const fields = [
                'strain_name_th', 'strain_name_en', 'breeder', 'strain_type',
                'thc_percentage', 'cbd_percentage', 'grade',
                'top_terpenes_1', 'top_terpenes_2', 'top_terpenes_3',
                'recommended_time', 'grow_method', 'harvest_date',
                'batch_number', 'fertilizer_type', 'flowering_type',
                'lab_test_name', 'test_type'
            ];

            fields.forEach(field => {
                const element = document.getElementById(field);
                if (element && budData[field] !== undefined && budData[field] !== null) {
                    element.value = budData[field];
                }
            });

            // Populate flavors
            if (budData.aroma_flavor) {
                selectedFlavors = budData.aroma_flavor.split(', ').filter(f => f.trim());
                updateSelectedFlavorsDisplay();
            }

            // Populate effects
            if (budData.mental_effects_positive) {
                selectedEffects.mentalPositive = budData.mental_effects_positive.split(', ').filter(e => e.trim());
                updateSelectedEffectsDisplay('mental-positive');
            }

            if (budData.mental_effects_negative) {
                selectedEffects.mentalNegative = budData.mental_effects_negative.split(', ').filter(e => e.trim());
                updateSelectedEffectsDisplay('mental-negative');
            }

            if (budData.physical_effects_positive) {
                selectedEffects.physicalPositive = budData.physical_effects_positive.split(', ').filter(e => e.trim());
                updateSelectedEffectsDisplay('physical-positive');
            }

            if (budData.physical_effects_negative) {
                selectedEffects.physicalNegative = budData.physical_effects_negative.split(', ').filter(e => e.trim());
                updateSelectedEffectsDisplay('physical-negative');
            }
        }

        // Image handling functions for bud images
        function initializeImageUpload() {
            for (let i = 1; i <= 4; i++) {
                const input = document.getElementById(`image_${i}`);
                if (input) {
                    input.addEventListener('change', function(e) {
                        handleImageSelect(i, e.target.files[0]);
                    });
                }
            }
        }

        function handleImageSelect(index, file) {
            if (!file) return;

            // Validate file type
            if (!file.type.startsWith('image/')) {
                showAlert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô', 'error');
                return;
            }

            // Validate file size (16MB)
            if (file.size > 16 * 1024 * 1024) {
                showAlert('‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 16MB', 'error');
                return;
            }

            // Show preview
            const reader = new FileReader();
            reader.onload = function(e) {
                showImagePreview(index, e.target.result);
            };
            reader.readAsDataURL(file);
        }

        function showImagePreview(index, src) {
            const label = document.querySelector(`label[for="image_${index}"]`);
            const preview = document.getElementById(`preview_${index}`);
            const current = document.getElementById(`current_${index}`);

            if (label && preview) {
                label.style.display = 'none';
                if (current) current.style.display = 'none';
                preview.style.display = 'block';
                preview.querySelector('img').src = src;
            }
        }

        function removeImage(index) {
            const input = document.getElementById(`image_${index}`);
            const label = document.querySelector(`label[for="image_${index}"]`);
            const preview = document.getElementById(`preview_${index}`);
            const current = document.getElementById(`current_${index}`);

            if (input) input.value = '';
            if (label) label.style.display = 'block';
            if (preview) {
                preview.style.display = 'none';
                preview.querySelector('img').src = '';
            }
            if (current) {
                current.style.display = 'none';
                current.querySelector('img').src = '';
            }
        }

        function clearAllImages() {
            for (let i = 1; i <= 4; i++) {
                removeImage(i);
                removeCurrentImage(i);
            }
        }

        // Image handling functions for certificate images
        function initializeCertificateImageUpload() {
            for (let i = 1; i <= 4; i++) {
                const input = document.getElementById(`certificate_image_${i}`);
                if (input) {
                    input.addEventListener('change', function(e) {
                        handleCertificateImageSelect(i, e.target.files[0]);
                    });
                }
            }
        }

        function handleCertificateImageSelect(index, file) {
            if (!file) return;

            if (!file.type.startsWith('image/')) {
                showAlert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô', 'error');
                return;
            }

            if (file.size > 16 * 1024 * 1024) {
                showAlert('‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 16MB', 'error');
                return;
            }

            const reader = new FileReader();
            reader.onload = function(e) {
                showCertificateImagePreview(index, e.target.result);
            };
            reader.readAsDataURL(file);
        }

        function showCertificateImagePreview(index, src) {
            const label = document.querySelector(`label[for="certificate_image_${index}"]`);
            const preview = document.getElementById(`certificate_preview_${index}`);
            const current = document.getElementById(`current_certificate_${index}`);

            if (label && preview) {
                label.style.display = 'none';
                if (current) current.style.display = 'none';
                preview.style.display = 'block';
                preview.querySelector('img').src = src;
            }
        }

        function removeCurrentCertificateImage(index) {
            const label = document.querySelector(`label[for="certificate_image_${index}"]`);
            const current = document.getElementById(`current_certificate_${index}`);
            const input = document.getElementById(`certificate_image_${index}`);

            if (label && current) {
                current.style.display = 'none';
                current.querySelector('img').src = '';
                label.style.display = 'block';
                if (input) input.value = '';

                current.setAttribute('data-deleted', 'true');
                let deletionInput = document.getElementById(`deleted_certificate_image_${index}`);
                if (!deletionInput) {
                    deletionInput = document.createElement('input');
                    deletionInput.type = 'hidden';
                    deletionInput.id = `deleted_certificate_image_${index}`;
                    deletionInput.name = `deleted_certificate_image_${index}`;
                    document.getElementById('editBudForm').appendChild(deletionInput);
                }
                deletionInput.value = 'true';
            }
        }

        function replaceCurrentCertificateImage(index) {
            const input = document.getElementById(`certificate_image_${index}`);
            if (input) {
                const current = document.getElementById(`current_certificate_${index}`);
                if (current) {
                    current.removeAttribute('data-deleted');
                }
                const deletionInput = document.getElementById(`deleted_certificate_image_${index}`);
                if (deletionInput) {
                    deletionInput.remove();
                }
                input.click();
            }
        }

        function removeCertificateImage(index) {
            const input = document.getElementById(`certificate_image_${index}`);
            const label = document.querySelector(`label[for="certificate_image_${index}"]`);
            const preview = document.getElementById(`certificate_preview_${index}`);
            const current = document.getElementById(`current_certificate_${index}`);

            if (input) input.value = '';
            if (label) label.style.display = 'block';
            if (preview) {
                preview.style.display = 'none';
                preview.querySelector('img').src = '';
            }
            if (current) {
                current.style.display = 'none';
                current.querySelector('img').src = '';
            }
        }

        function clearAllCertificateImages() {
            for (let i = 1; i <= 4; i++) {
                removeCertificateImage(i);
                removeCurrentCertificateImage(i);
            }
        }

        function loadCurrentCertificateImages(budData) {
            for (let i = 1; i <= 4; i++) {
                const imageUrl = budData[`certificate_image_${i}_url`];
                if (imageUrl) {
                    showCurrentCertificateImage(i, imageUrl);
                }
            }
        }

        function showCurrentCertificateImage(index, imageUrl) {
            const label = document.querySelector(`label[for="certificate_image_${index}"]`);
            const preview = document.getElementById(`certificate_preview_${index}`);
            const current = document.getElementById(`current_certificate_${index}`);

            if (label && current) {
                label.style.display = 'none';
                if (preview) preview.style.display = 'none';
                current.style.display = 'block';
                current.querySelector('img').src = imageUrl;
            }
        }

        async function uploadImages() {
            const formData = new FormData();
            let hasImages = false;

            // Add bud image files to form data
            for (let i = 1; i <= 4; i++) {
                const input = document.getElementById(`image_${i}`);
                if (input && input.files[0]) {
                    formData.append(`image_${i}`, input.files[0]);
                    hasImages = true;
                }
            }

            // Add certificate image files to form data
            for (let i = 1; i <= 4; i++) {
                const input = document.getElementById(`certificate_image_${i}`);
                if (input && input.files[0]) {
                    formData.append(`certificate_image_${i}`, input.files[0]);
                    hasImages = true;
                }
            }

            if (!hasImages) {
                return { success: true, message: '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÉ‡∏´‡∏°‡πà‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î' };
            }

            try {
                const response = await fetch(`/api/buds/${currentBudId}/upload-images`, {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();
                return result;
            } catch (error) {
                console.error('Error uploading images:', error);
                return { success: false, error: '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û' };
            }
        }

        async function handleSubmit(event) {
            event.preventDefault();

            if (isLoading || !currentBudId) return;

            const submitBtn = document.getElementById('submitBtn');
            const originalText = submitBtn.textContent;

            try {
                isLoading = true;
                submitBtn.disabled = true;
                submitBtn.textContent = 'üíæ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';

                // First, update bud data
                const formData = new FormData(document.getElementById('editBudForm'));
                const data = Object.fromEntries(formData);

                // Remove image files from data (they will be handled separately)
                delete data.image_1;
                delete data.image_2;
                delete data.image_3;
                delete data.image_4;
                delete data.certificate_image_1;
                delete data.certificate_image_2;
                delete data.certificate_image_3;
                delete data.certificate_image_4;


                // Keep deletion flags
                // deleted_image_* and deleted_certificate_image_* fields will be included in data automatically

                // Convert numeric fields
                if (data.thc_percentage) data.thc_percentage = parseFloat(data.thc_percentage);
                if (data.cbd_percentage) data.cbd_percentage = parseFloat(data.cbd_percentage);

                const response = await fetch(`/api/buds/${currentBudId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.json();

                if (!response.ok || !result.success) {
                    throw new Error(result.error || '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ');
                }

                // Then, upload images if any
                submitBtn.textContent = 'üì∑ ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û...';
                const imageResult = await uploadImages();

                if (!imageResult.success && imageResult.error) {
                    console.warn('Image upload warning:', imageResult.error);
                    showAlert('‚ö†Ô∏è ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡πÅ‡∏ï‡πà‡∏°‡∏µ‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û: ' + imageResult.error, 'error');
                } else {
                    showAlert('‚úÖ ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡∏≠‡∏Å‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!');
                }

                setTimeout(() => {
                    window.location.href = '/activity';
                }, 2000);

            } catch (error) {
                console.error('Error updating bud:', error);
                showAlert('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ' + error.message, 'error');
            } finally {
                isLoading = false;
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
            }
        }

        // Make functions globally accessible
        window.removeImage = removeImage;
        window.clearAllImages = clearAllImages;
        window.removeCurrentImage = removeCurrentImage;
        window.replaceCurrentImage = replaceCurrentImage;
        window.removeCertificateImage = removeCertificateImage;
        window.clearAllCertificateImages = clearAllCertificateImages;
        window.removeCurrentCertificateImage = removeCurrentCertificateImage;
        window.replaceCurrentCertificateImage = replaceCurrentCertificateImage;


        function retryLoadBud() {
            // Reset loading state before retry
            isLoading = false;
            currentBudId = null;

            // Clear form to force reload
            const form = document.getElementById('editBudForm');
            if (form) {
                form.reset();
            }

            loadBudData();
        }

        // Autocomplete functionality
        class StrainAutocomplete {
            constructor(inputId, suggestionsId, language) {
                this.input = document.getElementById(inputId);
                this.suggestionsContainer = document.getElementById(suggestionsId);
                this.language = language;
                this.suggestions = [];
                this.selectedIndex = -1;
                this.searchTimeout = null;

                if (this.input && this.suggestionsContainer) {
                    this.init();
                }
            }

            init() {
                this.input.addEventListener('input', (e) => this.handleInput(e));
                this.input.addEventListener('keydown', (e) => this.handleKeydown(e));
                this.input.addEventListener('focus', (e) => this.handleFocus(e));
                this.input.addEventListener('blur', (e) => this.handleBlur(e));
            }

            handleInput(e) {
                const query = e.target.value.trim();

                if (this.searchTimeout) {
                    clearTimeout(this.searchTimeout);
                }

                this.searchTimeout = setTimeout(() => {
                    this.searchStrains(query);
                }, 300);
            }

            handleKeydown(e) {
                if (!this.suggestionsContainer.style.display || this.suggestionsContainer.style.display === 'none') {
                    return;
                }

                const items = this.suggestionsContainer.querySelectorAll('.suggestion-item');

                switch (e.key) {
                    case 'ArrowDown':
                        e.preventDefault();
                        this.selectedIndex = Math.min(this.selectedIndex + 1, items.length - 1);
                        this.updateSelection(items);
                        break;
                    case 'ArrowUp':
                        e.preventDefault();
                        this.selectedIndex = Math.max(this.selectedIndex - 1, -1);
                        this.updateSelection(items);
                        break;
                    case 'Enter':
                        e.preventDefault();
                        if (this.selectedIndex >= 0 && items[this.selectedIndex]) {
                            this.selectSuggestion(this.suggestions[this.selectedIndex]);
                        }
                        break;
                    case 'Escape':
                        this.hideSuggestions();
                        break;
                }
            }

            handleFocus(e) {
                if (!e.target.value.trim()) {
                    this.searchStrains('');
                }
            }

            handleBlur(e) {
                setTimeout(() => {
                    this.hideSuggestions();
                }, 150);
            }

            updateSelection(items) {
                items.forEach((item, index) => {
                    item.classList.toggle('selected', index === this.selectedIndex);
                });
            }

            async searchStrains(query) {
                try {
                    const response = await fetch(`/api/strains/search?q=${encodeURIComponent(query)}&lang=${this.language}&limit=10`);

                    if (!response.ok) {
                        throw new Error('Search failed');
                    }

                    this.suggestions = await response.json();
                    this.displaySuggestions();
                } catch (error) {
                    console.error('Error fetching suggestions:', error);
                    this.suggestions = [];
                    this.displaySuggestions();
                }
            }

            displaySuggestions() {
                this.suggestionsContainer.innerHTML = '';
                this.selectedIndex = -1;

                if (this.suggestions.length === 0) {
                    const noResults = document.createElement('div');
                    noResults.className = 'no-suggestions';
                    noResults.textContent = '‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏™‡∏≤‡∏¢‡∏û‡∏±‡∏ô‡∏ò‡∏∏‡πå‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö‡∏Ñ‡∏≥‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤';
                    this.suggestionsContainer.appendChild(noResults);
                    this.showSuggestions();
                    return;
                }

                this.suggestions.forEach((suggestion, index) => {
                    const item = document.createElement('div');
                    item.className = 'suggestion-item';

                    const mainDiv = document.createElement('div');
                    mainDiv.className = 'suggestion-main';
                    mainDiv.textContent = suggestion.name;

                    const metaDiv = document.createElement('div');
                    metaDiv.className = 'suggestion-meta';

                    if (suggestion.is_popular) {
                        const popularBadge = document.createElement('span');
                        popularBadge.className = 'popular-badge';
                        popularBadge.textContent = '‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°';
                        metaDiv.appendChild(popularBadge);
                    }

                    if (suggestion.strain_type) {
                        const typeBadge = document.createElement('span');
                        typeBadge.className = 'strain-type-badge';
                        typeBadge.textContent = suggestion.strain_type;
                        metaDiv.appendChild(typeBadge);
                    }

                    item.appendChild(mainDiv);
                    item.appendChild(metaDiv);

                    item.addEventListener('click', () => {
                        this.selectSuggestion(suggestion);
                    });

                    this.suggestionsContainer.appendChild(item);
                });

                this.showSuggestions();
            }

            selectSuggestion(suggestion) {
                this.input.value = suggestion.name;
                this.hideSuggestions();

                if (suggestion.strain_type) {
                    const strainTypeSelect = document.getElementById('strain_type');
                    if (strainTypeSelect && strainTypeSelect.value === '') {
                        strainTypeSelect.value = suggestion.strain_type;
                    }
                }
            }

            showSuggestions() {
                this.suggestionsContainer.style.display = 'block';
            }

            hideSuggestions() {
                this.suggestionsContainer.style.display = 'none';
            }
        }

        // Initialize autocomplete for breeders
        function initializeBreederAutocomplete(inputId, suggestionsId, apiUrl) {
            const input = document.getElementById(inputId);
            const suggestionsContainer = document.getElementById(suggestionsId);

            if (!input || !suggestionsContainer) return;

            let currentSelection = -1;
            let suggestions = [];

            function showSuggestions(data) {
                suggestionsContainer.innerHTML = '';
                suggestions = data;
                currentSelection = -1;

                if (data.length === 0) {
                    suggestionsContainer.style.display = 'none';
                    return;
                }

                data.forEach((suggestion, index) => {
                    const item = document.createElement('div');
                    item.className = 'suggestion-item';

                    const mainDiv = document.createElement('div');
                    mainDiv.className = 'suggestion-main';
                    mainDiv.textContent = suggestion.name;

                    const metaDiv = document.createElement('div');
                    metaDiv.className = 'suggestion-meta';

                    if (suggestion.is_popular) {
                        const popularBadge = document.createElement('span');
                        popularBadge.className = 'popular-badge';
                        popularBadge.textContent = '‡∏¢‡∏≠‡∏î‡∏ô‡∏¥‡∏¢‡∏°';
                        metaDiv.appendChild(popularBadge);
                    }

                    item.appendChild(mainDiv);
                    item.appendChild(metaDiv);

                    item.addEventListener('click', () => {
                        input.value = suggestion.name;
                        suggestionsContainer.style.display = 'none';
                        input.focus();
                    });

                    suggestionsContainer.appendChild(item);
                });

                suggestionsContainer.style.display = 'block';
            }

            function hideSuggestions() {
                setTimeout(() => {
                    suggestionsContainer.style.display = 'none';
                }, 200);
            }

            function updateSelection() {
                const items = suggestionsContainer.querySelectorAll('.suggestion-item');
                items.forEach((item, index) => {
                    item.classList.toggle('selected', index === currentSelection);
                });
            }

            input.addEventListener('input', async (e) => {
                const query = e.target.value.trim();

                try {
                    const response = await fetch(`${apiUrl}?q=${encodeURIComponent(query)}&limit=10`);
                    const data = await response.json();
                    showSuggestions(data);
                } catch (error) {
                    console.error('Error fetching breeder suggestions:', error);
                    suggestionsContainer.innerHTML = '<div class="suggestion-item">‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</div>';
                    suggestionsContainer.style.display = 'block';
                }
            });

            input.addEventListener('focus', async () => {
                if (input.value.trim() === '') {
                    try {
                        const response = await fetch(`${apiUrl}?q=&limit=10`);
                        const data = await response.json();
                        showSuggestions(data);
                    } catch (error) {
                        console.error('Error fetching popular breeders:', error);
                    }
                }
            });

            input.addEventListener('blur', hideSuggestions);

            input.addEventListener('keydown', (e) => {
                const items = suggestionsContainer.querySelectorAll('.suggestion-item');

                if (e.key === 'ArrowDown') {
                    e.preventDefault();
                    currentSelection = Math.min(currentSelection + 1, items.length - 1);
                    updateSelection();
                } else if (e.key === 'ArrowUp') {
                    e.preventDefault();
                    currentSelection = Math.max(currentSelection - 1, -1);
                    updateSelection();
                } else if (e.key === 'Enter' && currentSelection >= 0) {
                    e.preventDefault();
                    if (suggestions[currentSelection]) {
                        input.value = suggestions[currentSelection].name;
                        suggestionsContainer.style.display = 'none';
                    }
                } else if (e.key === 'Escape') {
                    suggestionsContainer.style.display = 'none';
                    currentSelection = -1;
                }
            });
        }

        // Flavor Selector functionality
        function initializeFlavorSelector() {
            const selectedFlavorsDiv = document.getElementById('selected-flavors');
            const flavorCategoriesDiv = document.querySelector('.flavor-categories');
            const hiddenInput = document.getElementById('aroma_flavor');
            const flavorButtons = document.querySelectorAll('.flavor-btn');

            if (!selectedFlavorsDiv || !flavorCategoriesDiv || !hiddenInput) {
                console.warn('Flavor selector elements not found');
                return;
            }

            selectedFlavorsDiv.addEventListener('click', function() {
                const isActive = flavorCategoriesDiv.style.display === 'block';
                flavorCategoriesDiv.style.display = isActive ? 'none' : 'block';
            });

            document.addEventListener('click', function(e) {
                if (!e.target.closest('.aroma-selector')) {
                    flavorCategoriesDiv.style.display = 'none';
                }
            });

            flavorButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const flavor = this.getAttribute('data-flavor');

                    if (selectedFlavors.includes(flavor)) {
                        selectedFlavors = selectedFlavors.filter(f => f !== flavor);
                        this.classList.remove('selected');
                    } else {
                        selectedFlavors.push(flavor);
                        this.classList.add('selected');
                    }

                    updateSelectedFlavorsDisplay();
                });
            });
        }

        function updateSelectedFlavorsDisplay() {
            const selectedFlavorsDiv = document.getElementById('selected-flavors');
            const hiddenInput = document.getElementById('aroma_flavor');

            if (!selectedFlavorsDiv || !hiddenInput) return;

            hiddenInput.value = selectedFlavors.join(', ');

            if (selectedFlavors.length === 0) {
                selectedFlavorsDiv.innerHTML = '<span class="placeholder">‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Å‡∏•‡∏¥‡πà‡∏ô‡πÅ‡∏•‡∏∞‡∏£‡∏™...</span>';
            } else {
                const tagsHtml = selectedFlavors.map(flavor => 
                    `<div class="flavor-tag">
                        ${flavor}
                        <button type="button" class="remove-btn" onclick="removeFlavor('${flavor}')">√ó</button>
                    </div>`
                ).join('');

                selectedFlavorsDiv.innerHTML = tagsHtml + 
                    `<button type="button" class="clear-all-btn" onclick="clearAllFlavors()">‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>`;
            }

            // Update button states
            document.querySelectorAll('.flavor-btn').forEach(btn => {
                const flavor = btn.getAttribute('data-flavor');
                btn.classList.toggle('selected', selectedFlavors.includes(flavor));
            });
        }

        // Effects Selector functionality
        function initializeEffectsSelectors() {
            const effectsSelectors = [
                {
                    id: 'mental-positive',
                    selectedId: 'selected-mental-positive',
                    hiddenId: 'mental_effects_positive',
                    arrayKey: 'mentalPositive'
                },
                {
                    id: 'mental-negative',
                    selectedId: 'selected-mental-negative',
                    hiddenId: 'mental_effects_negative',
                    arrayKey: 'mentalNegative'
                },
                {
                    id: 'physical-positive',
                    selectedId: 'selected-physical-positive',
                    hiddenId: 'physical_effects_positive',
                    arrayKey: 'physicalPositive'
                },
                {
                    id: 'physical-negative',
                    selectedId: 'selected-physical-negative',
                    hiddenId: 'physical_effects_negative',
                    arrayKey: 'physicalNegative'
                }
            ];

            effectsSelectors.forEach(selector => {
                const selectedDiv = document.getElementById(selector.selectedId);
                const hiddenInput = document.getElementById(selector.hiddenId);

                if (selectedDiv && hiddenInput) {
                    initializeEffectSelector(selector);
                }
            });
        }

        function initializeEffectSelector(config) {
            const selectedDiv = document.getElementById(config.selectedId);
            const hiddenInput = document.getElementById(config.hiddenId);

            if (!selectedDiv || !hiddenInput) return;

            const categoriesDiv = selectedDiv.nextElementSibling.nextElementSibling;

            if (!categoriesDiv) return;

            const effectButtons = categoriesDiv.querySelectorAll('.effect-btn');

            selectedDiv.addEventListener('click', function() {
                document.querySelectorAll('.effects-categories').forEach(cat => {
                    if (cat !== categoriesDiv) {
                        cat.style.display = 'none';
                    }
                });
                const isActive = categoriesDiv.style.display === 'block';
                categoriesDiv.style.display = isActive ? 'none' : 'block';
            });

            effectButtons.forEach(button => {
                button.addEventListener('click', function() {
                    const effect = this.getAttribute('data-effect');
                    const currentEffects = selectedEffects[config.arrayKey];

                    if (currentEffects.includes(effect)) {
                        selectedEffects[config.arrayKey] = currentEffects.filter(e => e !== effect);
                        this.classList.remove('selected');
                    } else {
                        selectedEffects[config.arrayKey].push(effect);
                        this.classList.add('selected');
                    }

                    updateSelectedEffectsDisplay(config.id);
                });
            });
        }

        function updateSelectedEffectsDisplay(effectType) {
            const configs = {
                'mental-positive': { selectedId: 'selected-mental-positive', hiddenId: 'mental_effects_positive', arrayKey: 'mentalPositive', placeholder: '‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏ö‡∏ß‡∏Å...' },
                'mental-negative': { selectedId: 'selected-mental-negative', hiddenId: 'mental_effects_negative', arrayKey: 'mentalNegative', placeholder: '‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏ö...' },
                'physical-positive': { selectedId: 'selected-physical-positive', hiddenId: 'physical_effects_positive', arrayKey: 'physicalPositive', placeholder: '‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏ö‡∏ß‡∏Å...' },
                'physical-negative': { selectedId: 'selected-physical-negative', hiddenId: 'physical_effects_negative', arrayKey: 'physicalNegative', placeholder: '‡∏Ñ‡∏•‡∏¥‡∏Å‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏•‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏ö...' }
            };

            const config = configs[effectType];
            if (!config) return;

            const selectedDiv = document.getElementById(config.selectedId);
            const hiddenInput = document.getElementById(config.hiddenId);
            const currentEffects = selectedEffects[config.arrayKey];

            if (!selectedDiv || !hiddenInput) return;

            hiddenInput.value = currentEffects.join(', ');

            if (currentEffects.length === 0) {
                selectedDiv.innerHTML = `<span class="placeholder">${config.placeholder}</span>`;
            } else {
                const isNegative = effectType.includes('negative');
                const tagsHtml = currentEffects.map(effect => 
                    `<div class="effect-tag ${isNegative ? 'negative' : ''}">
                        ${effect}
                        <button type="button" class="remove-btn" onclick="removeEffect('${effectType}', '${effect}')">√ó</button>
                    </div>`
                ).join('');

                selectedDiv.innerHTML = tagsHtml + 
                    `<button type="button" class="clear-all-btn" onclick="clearAllEffects('${effectType}')">‡∏•‡πâ‡∏≤‡∏á‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>`;
            }
        }

        // Global functions for removing flavors and effects
        window.removeFlavor = function(flavor) {
            selectedFlavors = selectedFlavors.filter(f => f !== flavor);
            updateSelectedFlavorsDisplay();
        };

        window.clearAllFlavors = function() {
            selectedFlavors = [];
            updateSelectedFlavorsDisplay();
        };

        window.removeEffect = function(effectType, effect) {
            const configs = {
                'mental-positive': 'mentalPositive',
                'mental-negative': 'mentalNegative',
                'physical-positive': 'physicalPositive',
                'physical-negative': 'physicalNegative'
            };

            const arrayKey = configs[effectType];
            if (arrayKey) {
                selectedEffects[arrayKey] = selectedEffects[arrayKey].filter(e => e !== effect);
                updateSelectedEffectsDisplay(effectType);

                // Update button state
                document.querySelectorAll('.effect-btn').forEach(btn => {
                    if (btn.getAttribute('data-effect') === effect) {
                        btn.classList.remove('selected');
                    }
                });
            }
        };

        window.clearAllEffects = function(effectType) {
            const configs = {
                'mental-positive': 'mentalPositive',
                'mental-negative': 'mentalNegative',
                'physical-positive': 'physicalPositive',
                'physical-negative': 'physicalNegative'
            };

            const arrayKey = configs[effectType];
            if (arrayKey) {
                selectedEffects[arrayKey] = [];
                updateSelectedEffectsDisplay(effectType);

                // Update button states
                const isNegative = effectType.includes('negative');
                const selector = isNegative ? '.effect-btn.negative' : '.effect-btn:not(.negative)';

                const container = document.getElementById(effectType.includes('mental') ? 
                    (effectType.includes('positive') ? 'selected-mental-positive' : 'selected-mental-negative') :
                    (effectType.includes('positive') ? 'selected-physical-positive' : 'selected-physical-negative'));

                if (container) {
                    const categoriesDiv = container.nextElementSibling.nextElementSibling;
                    if (categoriesDiv) {
                        categoriesDiv.querySelectorAll('.effect-btn').forEach(btn => {
                            btn.classList.remove('selected');
                        });
                    }
                }
            }
        };

        // Close effects categories when clicking outside (only add once)
        if (!window.effectsClickHandlerAdded) {
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.effects-selector')) {
                    document.querySelectorAll('.effects-categories').forEach(cat => {
                        cat.style.display = 'none';
                    });
                }
            });
            window.effectsClickHandlerAdded = true;
        }

        // Terpene Dropdown functionality
        function initializeTerpeneDropdowns() {
            for (let i = 1; i <= 3; i++) {
                const dropdown = document.getElementById(`terpene_${i}_select`);
                const hiddenInput = document.getElementById(`top_terpenes_${i}`);

                if (dropdown && hiddenInput) {
                    dropdown.addEventListener('change', function() {
                        const selectedValue = this.value;
                        hiddenInput.value = selectedValue;
                        
                        // Clear this selection from other dropdowns to prevent duplicates
                        for (let j = 1; j <= 3; j++) {
                            if (j !== i) {
                                const otherDropdown = document.getElementById(`terpene_${j}_select`);
                                if (otherDropdown && otherDropdown.value === selectedValue && selectedValue !== '') {
                                    otherDropdown.value = '';
                                    document.getElementById(`top_terpenes_${j}`).value = '';
                                }
                            }
                        }
                    });
                }
            }
        }

        // Function to load terpene data into the UI
        function loadTerpeneData(budData) {
            // Load existing top terpenes and percentages
            for (let i = 1; i <= 3; i++) {
                const hiddenInput = document.getElementById(`top_terpenes_${i}`);
                const dropdown = document.getElementById(`terpene_${i}_select`);
                const percentageInput = document.getElementById(`terpene_${i}_percentage`);
                
                if (hiddenInput && budData[`top_terpenes_${i}`]) {
                    hiddenInput.value = budData[`top_terpenes_${i}`];
                    
                    if (dropdown) {
                        dropdown.value = budData[`top_terpenes_${i}`];
                    }
                }
                
                if (percentageInput && budData[`terpene_${i}_percentage`]) {
                    percentageInput.value = budData[`terpene_${i}_percentage`];
                }
            }
        }


        // Prevent multiple initialization
        let isPageInitialized = false;

        // Initialize page when DOM is ready
        document.addEventListener('DOMContentLoaded', function() {
            if (isPageInitialized) {
                console.log('Page already initialized, skipping...');
                return;
            }

            console.log('Edit bud page initialized');
            isPageInitialized = true;

            const editForm = document.getElementById('editBudForm');
            if (editForm) {
                editForm.addEventListener('submit', handleSubmit);
            }

            try {
                new StrainAutocomplete('strain_name_en', 'suggestions_en', 'en');
                new StrainAutocomplete('strain_name_th', 'suggestions_th', 'th');
                initializeBreederAutocomplete('breeder', 'breeder-suggestions', '/api/breeders/search');
                initializeFlavorSelector();
                initializeEffectsSelectors();
                // Initialize image upload
                initializeImageUpload();
                initializeCertificateImageUpload();

                // Initialize flavor selector
                initializeFlavorSelector();
                // Initialize terpene dropdowns
                initializeTerpeneDropdowns();
            } catch (error) {
                console.error('Error initializing page features:', error);
            }

            // Load bud data only once
            if (!currentBudId) {
                loadBudData();
            }
        });
    </script>
</body>
</html>