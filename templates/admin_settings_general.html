<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cannabis App - ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .admin-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .admin-header {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
            padding: 30px;
            text-align: center;
            position: relative;
        }

        .back-btn {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
            text-decoration: none;
        }

        .back-btn:hover {
            background: rgba(255,255,255,0.3);
        }

        .admin-content {
            padding: 40px;
        }

        .form-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #28a745;
        }

        .toggle-group {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 34px;
        }

        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }

        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }

        .slider:before {
            position: absolute;
            content: "";
            height: 26px;
            width: 26px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        input:checked + .slider {
            background-color: #28a745;
        }

        input:checked + .slider:before {
            transform: translateX(26px);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .btn-success:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }

        .status-message {
            padding: 15px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: 600;
            text-align: center;
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        /* New styles for video settings */
        .settings-section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 20px;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }

        .setting-row {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 20px;
            flex-wrap: wrap; /* Added for responsiveness */
        }

        .setting-label {
            flex: 1;
            min-width: 180px; /* Minimum width for label */
        }

        .setting-title {
            font-weight: 600;
            color: #2c3e50;
            margin-bottom: 5px;
        }

        .setting-description {
            font-size: 12px;
            color: #6c757d;
        }

        .setting-control {
            flex-grow: 1; /* Allows control to take available space */
            min-width: 200px; /* Minimum width for control */
        }

        .text-input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        .text-input:focus {
            outline: none;
            border-color: #28a745;
        }

        .toggle-switch.active {
            background-color: #28a745;
        }

        .toggle-switch.active .toggle-slider {
            transform: translateX(26px);
            background-color: white;
        }

        .toggle-slider {
            position: absolute;
            cursor: pointer;
            top: 4px;
            left: 4px;
            height: 26px;
            width: 26px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }

        @media (max-width: 768px) {
            .admin-container {
                margin: 10px;
            }

            .admin-content {
                padding: 20px;
            }

            .form-section {
                padding: 20px;
            }

            .setting-row {
                flex-direction: column; /* Stack label and control on smaller screens */
                align-items: flex-start;
                gap: 10px;
            }

            .setting-label,
            .setting-control {
                min-width: unset; /* Remove min-width */
                width: 100%; /* Take full width */
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="admin-header">
            <a href="/admin/settings" class="back-btn">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡πÄ‡∏°‡∏ô‡∏π‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤</a>
            <h1>üîß ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏£‡∏∞‡∏ö‡∏ö‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</h1>
            <p>‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏£‡∏∞‡∏ö‡∏ö</p>
        </div>

        <div class="admin-content">
            <form id="generalSettingsForm">
                <div class="form-section">
                    <h3>üì± ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô</h3>

                    <div class="form-group">
                        <label for="siteName">‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå:</label>
                        <input type="text" id="siteName" name="siteName" required>
                    </div>

                    <div class="form-group">
                        <label for="siteDescription">‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡πÄ‡∏ß‡πá‡∏ö‡πÑ‡∏ã‡∏ï‡πå:</label>
                        <textarea id="siteDescription" name="siteDescription" rows="3"></textarea>
                    </div>

                    <div class="form-group">
                        <label for="adminEmail">‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö:</label>
                        <input type="email" id="adminEmail" name="adminEmail" required>
                    </div>
                </div>

                <div class="form-section">
                    <h3>üåê ‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•</h3>

                    <div class="form-group">
                        <label for="defaultLanguage">‡∏†‡∏≤‡∏©‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô:</label>
                        <select id="defaultLanguage" name="defaultLanguage">
                            <option value="th">‡πÑ‡∏ó‡∏¢</option>
                            <option value="en">English</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="displayMode">‡πÇ‡∏´‡∏°‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•:</label>
                        <select id="displayMode" name="displayMode">
                            <option value="auto">‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</option>
                            <option value="light">‡πÇ‡∏´‡∏°‡∏î‡∏™‡∏ß‡πà‡∏≤‡∏á</option>
                            <option value="dark">‡πÇ‡∏´‡∏°‡∏î‡∏°‡∏∑‡∏î</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="itemsPerPage">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ï‡πà‡∏≠‡∏´‡∏ô‡πâ‡∏≤:</label>
                        <input type="number" id="itemsPerPage" name="itemsPerPage" min="5" max="100">
                    </div>
                </div>

                <div class="form-section">
                    <h3>üîî ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏≠‡∏∑‡πà‡∏ô‡πÜ</h3>

                    <div class="form-group">
                        <label>‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô:</label>
                        <div class="toggle-group">
                            <label class="toggle-switch">
                                <input type="checkbox" id="enableNotifications" name="enableNotifications">
                                <span class="slider"></span>
                            </label>
                            <span id="notificationStatus">‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="registrationMode">‡πÇ‡∏´‡∏°‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å:</label>
                        <select id="registrationMode" name="registrationMode">
                            <option value="public">‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏ä‡πâ Referral Link)</option>
                            <option value="referral_only">‡∏™‡∏°‡∏±‡∏Ñ‡∏£‡∏ú‡πà‡∏≤‡∏ô Referral Link ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô</option>
                        </select>
                        <small style="color: #666; font-size: 12px; margin-top: 5px; display: block;">
                            ‡πÇ‡∏´‡∏°‡∏î‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô, ‡πÇ‡∏´‡∏°‡∏î Referral ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô Spam
                        </small>
                    </div>

                    <div class="form-group">
                        <label>‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÇ‡∏´‡∏°‡∏î‡∏ö‡∏≥‡∏£‡∏∏‡∏á‡∏£‡∏±‡∏Å‡∏©‡∏≤:</label>
                        <div class="toggle-group">
                            <label class="toggle-switch">
                                <input type="checkbox" id="maintenanceMode" name="maintenanceMode">
                                <span class="slider"></span>
                            </label>
                            <span id="maintenanceStatus">‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô</span>
                        </div>
                    </div>
                </div>

                <!-- Video Settings Section -->
                <div class="settings-section">
                    <div class="section-title">
                        üé• ‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠
                    </div>

                    <div class="setting-row">
                        <div class="setting-label">
                            <div class="setting-title">‡∏•‡∏¥‡∏á‡∏Ñ‡πå‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Auth</div>
                            <div class="setting-description">URL ‡∏Ç‡∏≠‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠ YouTube ‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</div>
                        </div>
                        <div class="setting-control">
                            <input type="url" class="text-input" data-setting="authVideoUrl" placeholder="https://www.youtube.com/embed/dQw4w9WgXcQ">
                        </div>
                    </div>

                    <div class="setting-row">
                        <div class="setting-label">
                            <div class="setting-title">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠</div>
                            <div class="setting-description">‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏µ‡πà‡πÅ‡∏™‡∏î‡∏á‡πÄ‡∏´‡∏ô‡∏∑‡∏≠‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Auth</div>
                        </div>
                        <div class="setting-control">
                            <input type="text" class="text-input" data-setting="authVideoTitle" placeholder="‡∏ó‡∏≥‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏à‡∏±‡∏Å Budt.Boy">
                        </div>
                    </div>

                    <div class="setting-row">
                        <div class="setting-label">
                            <div class="setting-title">‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ Auth</div>
                            <div class="setting-description">‡πÄ‡∏õ‡∏¥‡∏î/‡∏õ‡∏¥‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏™‡∏î‡∏á‡∏ß‡∏¥‡∏î‡∏µ‡πÇ‡∏≠‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</div>
                        </div>
                        <div class="setting-control">
                            <label class="toggle-switch">
                                <input type="checkbox" id="showAuthVideo" name="showAuthVideo" checked>
                                <span class="slider"></span>
                            </label>
                        </div>
                    </div>
                </div>

                <div id="statusMessage" style="display: none;"></div>

                <div style="text-align: center; margin-top: 30px;">
                    <button type="submit" class="btn btn-success" id="saveBtn">
                        üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        class GeneralSettings {
            constructor() {
                this.form = document.getElementById('generalSettingsForm');
                this.saveBtn = document.getElementById('saveBtn');
                this.statusMessage = document.getElementById('statusMessage');
                this.init();
            }

            async init() {
                // General Settings: Starting initialization
                this.setupEventListeners();
                await this.loadSettings();
            }

            setupEventListeners() {
                this.form.addEventListener('submit', (e) => this.handleSubmit(e));

                // Toggle switches
                document.getElementById('enableNotifications').addEventListener('change', (e) => {
                    document.getElementById('notificationStatus').textContent = e.target.checked ? '‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô' : '‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';
                });

                document.getElementById('maintenanceMode').addEventListener('change', (e) => {
                    document.getElementById('maintenanceStatus').textContent = e.target.checked ? '‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô' : '‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';
                });

                // Event listener for show video toggle
                document.getElementById('showAuthVideo').addEventListener('change', (e) => {
                    // Show video toggle changed
                });
            }

            async loadSettings() {
                try {
                    const response = await fetch('/api/admin/get_settings');
                    if (response.ok) {
                        const result = await response.json();
                        if (result.success && result.settings) {
                            this.populateForm(result.settings);
                        }
                    }
                } catch (error) {
                    console.error('Error loading settings:', error);
                    this.showMessage('‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•', 'error');
                }
            }

            populateForm(settings) {
                // Basic info
                document.getElementById('siteName').value = settings.siteName || 'Cannabis App';
                document.getElementById('siteDescription').value = settings.siteDescription || '';
                document.getElementById('adminEmail').value = settings.adminEmail || '';

                // Display settings
                document.getElementById('defaultLanguage').value = settings.defaultLanguage || 'th';
                document.getElementById('displayMode').value = settings.displayMode || 'auto';
                document.getElementById('itemsPerPage').value = settings.itemsPerPage || 20;

                // Registration mode
                document.getElementById('registrationMode').value = settings.registrationMode || 'public';

                // Toggles
                const enableNotifications = settings.enableNotifications === 'true' || settings.enableNotifications === true;
                const maintenanceMode = settings.maintenanceMode === 'true' || settings.maintenanceMode === true;

                document.getElementById('enableNotifications').checked = enableNotifications;
                document.getElementById('notificationStatus').textContent = enableNotifications ? '‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô' : '‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';

                document.getElementById('maintenanceMode').checked = maintenanceMode;
                document.getElementById('maintenanceStatus').textContent = maintenanceMode ? '‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô' : '‡∏õ‡∏¥‡∏î‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô';

                // Populate video settings
                document.querySelector('input[data-setting="authVideoUrl"]').value = settings.authVideoUrl || '';
                document.querySelector('input[data-setting="authVideoTitle"]').value = settings.authVideoTitle || '';
                const showAuthVideo = settings.showAuthVideo === 'true' || settings.showAuthVideo === true;
                document.getElementById('showAuthVideo').checked = showAuthVideo;
            }

            async handleSubmit(e) {
                e.preventDefault();

                this.saveBtn.textContent = '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...';
                this.saveBtn.disabled = true;

                const formData = new FormData(this.form);
                const settings = {
                    siteName: formData.get('siteName'),
                    siteDescription: formData.get('siteDescription'),
                    adminEmail: formData.get('adminEmail'),
                    defaultLanguage: formData.get('defaultLanguage'),
                    displayMode: formData.get('displayMode'),
                    itemsPerPage: parseInt(formData.get('itemsPerPage')),
                    registrationMode: formData.get('registrationMode'),
                    enableNotifications: document.getElementById('enableNotifications').checked,
                    maintenanceMode: document.getElementById('maintenanceMode').checked
                };

                // Get video settings from inputs
                settings.authVideoUrl = document.querySelector('input[data-setting="authVideoUrl"]').value.trim();
                settings.authVideoTitle = document.querySelector('input[data-setting="authVideoTitle"]').value.trim();
                settings.showAuthVideo = document.getElementById('showAuthVideo').checked;

                try {
                    // Saving general settings

                    const response = await fetch('/api/admin/settings/general', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(settings)
                    });

                    const result = await response.json();
                    // Save response received

                    if (response.ok && result.success) {
                        this.showMessage(`‚úÖ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! (${result.saved_count || '‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£'})`, 'success');
                    } else {
                        this.showMessage(`‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: ${result.error || '‡πÑ‡∏°‡πà‡∏ó‡∏£‡∏≤‡∏ö‡∏™‡∏≤‡πÄ‡∏´‡∏ï‡∏∏'}`, 'error');
                    }
                } catch (error) {
                    console.error('Error saving settings:', error);
                    this.showMessage('‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡πÄ‡∏ã‡∏¥‡∏£‡πå‡∏ü‡πÄ‡∏ß‡∏≠‡∏£‡πå', 'error');
                } finally {
                    this.saveBtn.textContent = 'üíæ ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Å‡∏≤‡∏£‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤';
                    this.saveBtn.disabled = false;
                }
            }

            showMessage(message, type) {
                this.statusMessage.textContent = message;
                this.statusMessage.className = `status-message ${type === 'success' ? 'success-message' : 'error-message'}`;
                this.statusMessage.style.display = 'block';

                setTimeout(() => {
                    this.statusMessage.style.display = 'none';
                }, 5000);
            }
        }

        // Initialize when DOM is ready
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', () => new GeneralSettings());
        } else {
            new GeneralSettings();
        }
    </script>
</body>
</html>